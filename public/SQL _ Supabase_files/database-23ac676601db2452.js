!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="880556ad-32c7-4740-8d6c-fa32db857043",e._sentryDebugIdIdentifier="sentry-dbid-880556ad-32c7-4740-8d6c-fa32db857043")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1675],{9672:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/settings/database",function(){return t(56323)}])},96956:function(e,s,t){"use strict";t.d(s,{O:function(){return c}});var n=t(36457),a=t(64618),o=t(34549),i=t(37870),r=t(37756),l=t(5731);async function d(e){let{projectRef:s,volumeSize:t}=e;if(!s)throw Error("projectRef is required");let n=await (0,i.v_)("".concat(r.T5,"/projects/").concat(s,"/resize"),{volume_size_gb:t});if(n.error)throw n.error;return n}let c=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,n.NL)();return(0,a.D)(e=>d(e),{async onSuccess(s,t,n){let{projectRef:a}=t;i.setQueriesData(l.Z.usage(a),e=>e?{...e,disk_volume_size_gb:t.volumeSize}:e),await (null==e?void 0:e(s,t,n))},async onError(e,t,n){void 0===s?o.Am.error("Failed to resize project disk: ".concat(e.message)):s(e,t,n)},...t})}},77769:function(e,s,t){"use strict";t.d(s,{YM:function(){return l}});var n=t(28894),a=t(25878),o=t(7324);let i=()=>"\nselect sum(pg_database_size(pg_database.datname))::bigint as db_size from pg_database;\n".trim();async function r(e,s){var t;let{projectRef:n,connectionString:o}=e,r=i(),{result:l}=await (0,a.R)({projectRef:n,connectionString:o,sql:r,queryKey:["database-size"]},s),d=null==l?void 0:null===(t=l[0])||void 0===t?void 0:t.db_size;if("number"!=typeof d)throw Error("Error fetching dbSize");return d}let l=function(e){let{projectRef:s,connectionString:t}=e,{enabled:a=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.a)(o.A.databaseSize(s),e=>{let{signal:n}=e;return r({projectRef:s,connectionString:t},n)},{enabled:a&&void 0!==s,...i})}},11907:function(e,s,t){"use strict";t.d(s,{E3:function(){return l}});var n=t(28894),a=t(25878),o=t(7324);let i=()=>"show max_connections";async function r(e,s){let{projectRef:t,connectionString:n}=e,o=i(),{result:r}=await (0,a.R)({projectRef:t,connectionString:n,sql:o,queryKey:["max-connections"]},s);return{maxConnections:parseInt(r[0].max_connections)}}let l=function(e){let{projectRef:s,connectionString:t}=e,{enabled:a=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.a)(o.A.maxConnections(s),e=>{let{signal:n}=e;return r({projectRef:s,connectionString:t},n)},{enabled:a&&void 0!==s,...i})}},53114:function(e,s,t){"use strict";t.d(s,{x:function(){return o}});var n=t(32691),a=t(52983);function o(){let{replace:e=!0,arrayKeys:s=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=JSON.stringify(s),o=(0,a.useMemo)(()=>new Set(s),[t]),i=(0,n.useRouter)(),r=(0,a.useMemo)(()=>Object.fromEntries(Object.entries(i.query).map(e=>{let[s,t]=e;return o.has(s)?Array.isArray(t)?[s,t]:[s,[t]]:[s,t]})),[o,i.query]),l=(0,a.useCallback)(s=>{let t="function"==typeof s?s(r):s,n=Object.fromEntries(Object.entries({...r,...t}).filter(e=>{let[,s]=e;return!!s}));(e?i.replace:i.push)({pathname:i.pathname,query:n},void 0,{shallow:!0,scroll:!1})},[i,r,e]);return[r,l]}},38210:function(e,s,t){"use strict";var n=t(97458),a=t(198),o=t(28977),i=t.n(o),r=t(90953),l=t(4839),d=t(83145),c=t.n(d),u=t(34549),m=t(18648),x=t(12436),p=t(88971),h=t(96956),f=t(69951),g=t(75541),y=t(42155),j=t(19540),v=t(10947),b=t(7756),w=t(90839),N=t(73500),S=t(89129);s.Z=e=>{var s,t,o,d,C;let{visible:P,loading:k,hideModal:z}=e,{ref:_}=(0,x.UO)(),{project:I,isLoading:M}=(0,p.d2)(),{lastDatabaseResizeAt:D}=null!=I?I:{},A=(0,g.l)(),{data:Z,isLoading:R}=(0,f.Gl)({orgSlug:null==A?void 0:A.slug}),F=null===D?0:360-i()().diff(D,"minutes"),T=F<=0,B=F<60?"".concat(F," minute(s)"):"".concat(Math.floor(F/60)," hours and ").concat(F%60," minute(s)"),{mutate:O,isLoading:L}=(0,h.O)({onSuccess:(e,s)=>{u.Am.success("Successfully updated disk size to ".concat(s.volumeSize," GB")),z(!1)}}),E=async e=>{if(!_)return console.error("Project ref is required");O({projectRef:_,volumeSize:e["new-disk-size"]})},V=null!==(C=null==I?void 0:I.volumeSizeGb)&&void 0!==C?C:0,G=(0,m.object)({"new-disk-size":(0,m.number)().required("Please enter a GB amount you want to resize the disk up to.").min(Number(null!=V?V:0),"Must be more than ".concat(V," GB")).max(Number(200),"Must not be more than 200 GB")});return(0,n.jsx)(y.Z,{header:"Increase Disk Storage Size",size:"medium",visible:P,loading:k,onCancel:()=>z(!1),hideFooter:!0,"data-sentry-element":"Modal","data-sentry-component":"DiskSizeConfigurationModal","data-sentry-source-file":"DiskSizeConfigurationModal.tsx",children:M||R?(0,n.jsxs)("div",{className:"flex flex-col gap-4 p-4",children:[(0,n.jsx)(S.Z,{}),(0,n.jsx)(S.Z,{})]}):(null==Z?void 0:Z.usage_billing_enabled)===!0?(0,n.jsx)(j.Z,{name:"disk-resize-form",initialValues:{"new-disk-size":V},validationSchema:G,onSubmit:E,children:()=>V>=200?(0,n.jsxs)(v.bZ,{variant:"warning",className:"rounded-t-none border-0",children:[(0,n.jsx)(b.aN,{}),(0,n.jsx)(v.Cd,{children:"Maximum manual disk size increase reached"}),(0,n.jsxs)(v.X,{children:[(0,n.jsxs)("p",{children:["You cannot manually expand the disk size any more than ",200,"GB. If you need more than this, contact us via support for help."]}),(0,n.jsx)(w.z,{asChild:!0,type:"default",className:"mt-3",children:(0,n.jsx)(c(),{href:"/support/new?ref=".concat(_,"&category=").concat(a.DH.PERFORMANCE_ISSUES,"&subject=Increase%20disk%20size%20beyond%20200GB"),children:"Contact support"})})]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(y.Z.Content,{className:"w-full space-y-4",children:[(0,n.jsxs)(v.bZ,{variant:T?"default":"warning",children:[(0,n.jsx)(r.Z,{size:16}),(0,n.jsx)(v.Cd,{children:"This operation is only possible every 6 hours"}),(0,n.jsxs)(v.X,{children:[(0,n.jsx)("div",{className:"mb-4",children:T?"Upon updating your disk size, the next disk size update will only be available from ".concat(i()().format("DD MMM YYYY, HH:mm (ZZ)")):"Your database was last resized at ".concat(i()(D).format("DD MMM YYYY, HH:mm (ZZ)"),". You can resize your database again in approximately ").concat(B)}),(0,n.jsx)(w.z,{asChild:!0,type:"default",iconRight:(0,n.jsx)(l.Z,{size:14}),children:(0,n.jsx)(c(),{href:"https://supabase.com/docs/guides/platform/database-size#disk-management",children:"Read more about disk management"})})]})]}),(0,n.jsx)(N.Z,{required:!0,id:"new-disk-size",label:"New disk size",labelOptional:"GB",disabled:!T})]}),(0,n.jsx)(y.Z.Separator,{}),(0,n.jsxs)(y.Z.Content,{className:"flex space-x-2 justify-end",children:[(0,n.jsx)(w.z,{type:"default",onClick:()=>z(!1),children:"Cancel"}),(0,n.jsx)(w.z,{htmlType:"submit",type:"primary",disabled:!T||L,loading:L,children:"Update disk size"})]})]})}):(0,n.jsxs)(v.bZ,{className:"border-none",children:[(0,n.jsx)(b.sz,{}),(0,n.jsx)(v.Cd,{children:(null==Z?void 0:null===(s=Z.plan)||void 0===s?void 0:s.id)==="free"?"Disk size configuration is not available for projects on the Free Plan":"Disk size configuration is only available when the spend cap has been disabled"}),(0,n.jsxs)(v.X,{children:[(null==Z?void 0:null===(t=Z.plan)||void 0===t?void 0:t.id)==="free"?(0,n.jsx)("p",{children:"If you are intending to use more than 500MB of disk space, then you will need to upgrade to at least the Pro Plan."}):(0,n.jsx)("p",{children:"If you are intending to use more than 8GB of disk space, then you will need to disable your spend cap."}),(0,n.jsx)(w.z,{asChild:!0,type:"default",className:"mt-3",children:(0,n.jsx)(c(),{href:"/org/".concat(null==A?void 0:A.slug,"/billing?panel=").concat((null==Z?void 0:null===(o=Z.plan)||void 0===o?void 0:o.id)==="free"?"subscriptionPlan":"costControl"),target:"_blank",children:(null==Z?void 0:null===(d=Z.plan)||void 0===d?void 0:d.id)==="free"?"Upgrade subscription":"Disable spend cap"})})]})]})})}},59461:function(e,s,t){"use strict";t.d(s,{i:function(){return o}});var n=t(97458),a=t(90839);let o=e=>{let{form:s,hasChanges:t,handleReset:o,helper:i,disabled:r=!1,isSubmitting:l,submitText:d="Save"}=e,c=l||r||!t&&void 0!==t;return(0,n.jsxs)("div",{className:["flex w-full items-center gap-2",i?"justify-between":"justify-end"].join(" "),"data-sentry-component":"FormActions","data-sentry-source-file":"FormActions.tsx",children:[i&&(0,n.jsx)("span",{className:"text-sm text-foreground-lighter",children:i}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(a.z,{disabled:c,type:"default",htmlType:"reset",onClick:()=>o(),"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:"Cancel"}),(0,n.jsx)(a.z,{form:s,type:"primary",htmlType:"submit",disabled:c,loading:l,"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:d})]})]})}},24083:function(e,s,t){"use strict";t.d(s,{p:function(){return i}});var n=t(97458),a=t(65092),o=t(67096);let i=e=>{let{title:s,description:t,docsUrl:i,actions:r,className:l}=e;return(0,n.jsxs)("div",{className:(0,a.cn)("w-full mb-6 flex flex-col sm:flex-row md:items-center justify-between gap-4 ".concat(l)),"data-sentry-component":"FormHeader","data-sentry-source-file":"FormHeader.tsx",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("h3",{className:"text-foreground text-xl prose",children:s}),t&&(0,n.jsx)("div",{className:"prose text-sm max-w-full",children:t})]}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row md:items-center gap-x-2",children:[void 0!==i&&(0,n.jsx)(o.G,{href:i}),r]})]})}},87696:function(e,s,t){"use strict";t.d(s,{DO:function(){return d},Tq:function(){return r},by:function(){return i},iL:function(){return l},m9:function(){return c}});var n=t(97458),a=t(52983),o=t(65092);let i=e=>{let{children:s,header:t,footer:a}=e;return(0,n.jsxs)(r,{"data-sentry-element":"FormPanelContainer","data-sentry-component":"FormPanel","data-sentry-source-file":"FormPanel.tsx",children:[t&&(0,n.jsx)(l,{children:t}),(0,n.jsx)(d,{className:"divide-y","data-sentry-element":"FormPanelContent","data-sentry-source-file":"FormPanel.tsx",children:s}),a&&(0,n.jsx)(c,{children:a})]})},r=(0,a.forwardRef)((e,s)=>{let{children:t,...a}=e;return(0,n.jsx)("div",{ref:s,...a,className:(0,o.cn)("bg-surface-100 border overflow-hidden rounded-md shadow max-w-full",a.className),children:t})});r.displayName=r.displayName;let l=(0,a.forwardRef)((e,s)=>{let{children:t,...a}=e;return(0,n.jsx)("div",{ref:s,...a,className:(0,o.cn)("border-default border-b px-8 py-4",a.className),children:t})});l.displayName=l.displayName;let d=(0,a.forwardRef)((e,s)=>{let{children:t,...a}=e;return(0,n.jsx)("div",{ref:s,...a,className:(0,o.cn)("divide-border flex flex-col gap-0",a.className),children:t})});d.displayName=d.displayName;let c=(0,a.forwardRef)((e,s)=>{let{children:t,...a}=e;return(0,n.jsx)("div",{ref:s,...a,className:(0,o.cn)("border-t",a.className),children:t})});c.displayName=c.displayName},46993:function(e,s,t){"use strict";t.d(s,{B4:function(){return l},S0:function(){return i},hj:function(){return o}});var n=t(97458),a=t(52983);let o=e=>{let{children:s,id:t,header:a,disabled:o,className:i}=e;return(0,n.jsxs)("div",{id:t,className:["grid grid-cols-12 gap-6 px-4 md:px-8 py-4 md:py-8","".concat(o?" opacity-30":" opacity-100"),"".concat(i)].join(" "),"data-sentry-component":"FormSection","data-sentry-source-file":"FormSection.tsx",children:[a,s]})},i=e=>{let{children:s,className:t="",description:a}=e;return void 0!==a?(0,n.jsxs)("div",{className:"flex flex-col space-y-2 col-span-12 lg:col-span-5 ".concat(t),children:[(0,n.jsx)("label",{className:"text-foreground text-sm",children:s}),a]}):(0,n.jsx)("label",{className:"text-foreground col-span-12 text-sm lg:col-span-5 ".concat(t),children:s})},r=()=>(0,n.jsxs)("div",{className:"flex w-full flex-col gap-2","data-sentry-component":"Shimmer","data-sentry-source-file":"FormSection.tsx",children:[(0,n.jsx)("div",{className:"shimmering-loader h-2 w-1/3 rounded"}),(0,n.jsx)("div",{className:"flex flex-col justify-between space-y-2",children:(0,n.jsx)("div",{className:"shimmering-loader h-[34px] w-2/3 rounded"})})]}),l=e=>{let{children:s,loading:t=!0,fullWidth:o,className:i}=e;return(0,n.jsx)("div",{className:"\n        relative col-span-12 flex flex-col gap-6 lg:col-span-7\n        ".concat(o&&"!col-span-12","\n        ").concat(i,"\n      "),"data-sentry-component":"FormSectionContent","data-sentry-source-file":"FormSection.tsx",children:t?a.Children.map(s,()=>(0,n.jsx)(r,{})):s})}},13064:function(e,s,t){"use strict";var n=t(97458),a=t(1707),o=t(38232),i=t(4839),r=t(83145),l=t.n(r),d=t(52983),c=t(90839);let u=(0,d.forwardRef)((e,s)=>{let{icon:t,title:r,description:u,url:m,urlLabel:x="Read more",defaultVisibility:p=!1,hideCollapse:h=!1,button:f,className:g="",block:y=!1}=e,[j,v]=(0,d.useState)(p);return(0,n.jsx)("div",{ref:s,role:"alert",className:"".concat(y?"block w-full":"","\n      block w-full rounded-md border bg-surface-300/25 py-3 ").concat(g),children:(0,n.jsxs)("div",{className:"flex flex-col px-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex w-full space-x-3 items-center",children:[t&&(0,n.jsx)("span",{className:"text-foreground-lighter",children:t}),(0,n.jsx)("div",{className:"flex-grow",children:(0,n.jsx)("h5",{className:"text-sm text-foreground",children:r})})]}),u&&!h?(0,n.jsx)("div",{className:"cursor-pointer text-foreground-lighter",onClick:()=>v(!j),children:j?(0,n.jsx)(a.Z,{size:14,strokeWidth:1.5}):(0,n.jsx)(o.Z,{size:14,strokeWidth:1.5})}):null]}),(u||m||f)&&(0,n.jsxs)("div",{className:"flex flex-col space-y-3 overflow-hidden transition-all ".concat(j?"mt-3":""),style:{maxHeight:j?500:0},children:[(0,n.jsx)("div",{className:"text-foreground-light text-sm",children:u}),m&&(0,n.jsx)("div",{children:(0,n.jsx)(c.z,{asChild:!0,type:"default",icon:(0,n.jsx)(i.Z,{}),children:(0,n.jsx)(l(),{href:m,target:"_blank",rel:"noreferrer",children:x})})}),f&&(0,n.jsx)("div",{children:f})]})]})})});u.displayName="InformationBox",s.Z=u},92303:function(e,s,t){"use strict";var n=t(97458),a=t(37756);s.Z=e=>{let{passwordStrengthScore:s=0,passwordStrengthMessage:t="",password:o="",generateStrongPassword:i}=e;return(0,n.jsxs)(n.Fragment,{children:[o&&(0,n.jsx)("div",{"aria-valuemax":100,"aria-valuemin":0,"aria-valuenow":a.sL[s],"aria-valuetext":a.sL[s],role:"progressbar",className:"mb-2 overflow-hidden transition-all border rounded bg-200 w-full",children:(0,n.jsx)("div",{style:{width:a.sL[s]},className:"relative h-1 w-full ".concat(a.bV[s]," transition-all duration-500 ease-out shadow-inner")})}),(0,n.jsxs)("p",{children:[t||"This is the password to your Postgres database, so it must be strong and hard to guess."," ",(0,n.jsx)("span",{className:"text-foreground opacity-50 underline hover:opacity-100 transition cursor-pointer",onClick:i,children:"Generate a password"})]})]})}},46615:function(e,s,t){"use strict";t.d(s,{Q:function(){return o}});var n=t(76463),a=t.n(n);let o=()=>a().generate({length:16,numbers:!0,uppercase:!0})},56323:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return sK}});var n=t(97458),a=t(78751),o=t(198),i=t(59171),r=t(16402),l=t(90953),d=t(96056),c=t(14458),u=t(83145),m=t.n(u),x=t(52983),p=t(86848),h=t(34549),f=t(12436),g=t(76063),y=t(88971),j=t(67096),v=t(24083),b=t(29915),w=t(86688),N=t(75448),S=t(2343),C=t(69951),P=t(9108),k=t(90817),z=t(75541),_=t(21786),I=t(37756),M=t(90839),D=t(10947),A=t(49142),Z=t(15271),R=t(76087),F=t(73565),T=t(40577),B=t(56740),O=t(11221),L=t(33526),E=t(78366),V=t(6618),G=t(49996),Y=t(32880),U=t(19047),q=t(98451),H=t(30851),W=t(31843),X=t(29980),J=t(57975),K=t(25534),Q=t(59436);function $(){var e,s,t,u,$,ee,es,et,en,ea,eo,ei,er,el,ed,ec,eu;let{project:em}=(0,y.d2)(),ex=(0,z.l)(),{ref:ep}=(0,f.UO)(),eh=(0,_.P)("diskAndComputeForm"),[ef,eg]=(0,x.useState)(!1),[ey,ej]=(0,x.useState)(0),[ev,eb]=(0,x.useState)(!1),ew=(0,k.Xo)(o.KA.UPDATE,"projects",{resource:{project_id:null==em?void 0:em.id}}),{data:eN}=(0,S.bN)({projectRef:ep}),eS=(null!=eN?eN:[]).filter(e=>e.identifier!==ep),{data:eC,isSuccess:eP}=(0,b.IG)({projectRef:ep},{refetchInterval:ev,refetchOnWindowFocus:!1,onSuccess:e=>{var s;let{type:t,iops:n,throughput_mbps:a,size_gb:o}=null!==(s=null==e?void 0:e.attributes)&&void 0!==s?s:{size_gb:0};"requested_modification"in e||!1===ev||(eq.reset({storageType:t,provisionedIOPS:n,throughput:a,totalSize:o}),eb(!1),h.Am.success("Disk configuration changes have been successfully applied!"))}}),{type:ek,iops:ez,throughput_mbps:e_,size_gb:eI}=null!==(ea=null==eC?void 0:eC.attributes)&&void 0!==ea?ea:{size_gb:0},eM=(null==eC?void 0:eC.requested_modification)!==void 0,{remainingDuration:eD,isWithinCooldownWindow:eA}=(0,b.WU)({projectRef:ep}),{data:eZ}=(0,P.F)({projectRef:ep}),eR=null===(e=(null!==(eo=null==eZ?void 0:eZ.selected_addons)&&void 0!==eo?eo:[]).find(e=>"compute_instance"===e.type))||void 0===e?void 0:e.variant,eF=X.FJ[null!==(ei=null==eR?void 0:eR.identifier)&&void 0!==ei?ei:""],eT=X.OR[null!==(er=null==eR?void 0:eR.identifier)&&void 0!==er?er:""],{data:eB}=(0,C.Gl)({orgSlug:null==ex?void 0:ex.slug}),eO=null!==(el=null==eB?void 0:eB.plan.id)&&void 0!==el?el:"free",eL=(null==eB?void 0:eB.plan.id)==="pro"&&!eB.usage_billing_enabled,{data:eE}=(0,N.C)({projectRef:ep}),eV=Math.round((null!==(ed=null==eE?void 0:eE.metrics.fs_used_bytes)&&void 0!==ed?ed:0)/I.GB*100)/100,{mutate:eG,isLoading:eY}=(0,w.H$)({onSuccess:(e,s)=>{h.Am.success("Successfully requested disk configuration changes! Your changes will be applied shortly");let{ref:t,...n}=s;eg(!1),eb(3e3),eq.reset(n)}}),eU={storageType:ek||X.Hb.GP3,provisionedIOPS:ez,throughput:e_,totalSize:eI,computeSize:void 0},eq=(0,p.cI)({resolver:(0,a.F)((0,Y.m)(eU.totalSize)),defaultValues:eU,mode:"onBlur",reValidateMode:"onChange"}),{watch:eH,setValue:eW,trigger:eX,control:eJ,formState:eK}=eq,eQ=eH("storageType"),e$=eH("totalSize"),e0=eH("provisionedIOPS"),{dirtyFields:e1}=eK,e2=!!e1.totalSize,e4=eM||eL||eA||!ew,{includedDiskGB:e3}=X.UT[eO],e5=e3[eQ],e8=null!==(ec=null===(s=X.nG[eQ])||void 0===s?void 0:s.min)&&void 0!==ec?ec:0,e6="gp3"===eQ?Math.min(500*e$,X.nG[X.Hb.GP3].max):Math.min(1e3*e$,X.nG[X.Hb.IO2].max),e9="gp3"===eQ&&null!==(eu=null===(t=X.YX[eQ])||void 0===t?void 0:t.min)&&void 0!==eu?eu:0,e7="gp3"===eQ?Math.min(.25*e0,X.YX[X.Hb.GP3].max):void 0,se=async e=>{if(void 0===ep)return console.error("Project ref is required");eG({ref:ep,...e})};function ss(e){return"io2"===e?X.Hb.IO2:"gp3"===e?X.Hb.GP3:X.Hb.IO2}let st=eq.getValues("storageType"),sn=(0,U.Pl)({planId:eO,oldSize:(null===(u=eq.formState.defaultValues)||void 0===u?void 0:u.totalSize)||0,oldStorageType:ss((null===($=eq.formState.defaultValues)||void 0===$?void 0:$.storageType)||"io2"),newSize:eq.getValues("totalSize"),newStorageType:ss(st)}),sa=(0,U.G0)({oldStorageType:null===(ee=eq.formState.defaultValues)||void 0===ee?void 0:ee.storageType,oldProvisionedIOPS:(null===(es=eq.formState.defaultValues)||void 0===es?void 0:es.provisionedIOPS)||0,newStorageType:eq.getValues("storageType"),newProvisionedIOPS:eq.getValues("provisionedIOPS")}),so=(0,U.r8)({storageType:eq.getValues("storageType"),newThroughput:eq.getValues("throughput")||0,oldThroughput:(null===(et=eq.formState.defaultValues)||void 0===et?void 0:et.throughput)||0});return((0,x.useEffect)(()=>{eP&&eq.reset(eU)},[eP]),(0,x.useEffect)(()=>{if("io2"===eQ)eW("throughput",void 0);else if("gp3"===eQ){let e=eq.getValues("throughput"),{min:s,max:t}=X.YX[X.Hb.GP3];(!e||e<s||e>t)&&eW("throughput",s)}},[eQ,e$,eW,eq]),(0,x.useEffect)(()=>{eD>0&&ej(eD)},[eD]),(0,x.useEffect)(()=>{if(ey<=0)return;let e=setInterval(()=>{ej(Math.max(0,ey-1))},1e3);return()=>clearInterval(e)},[ey]),eh)?(0,n.jsxs)("div",{id:"disk-management",children:[(0,n.jsx)(v.p,{title:"Disk Management",docsUrl:"https://supabase.com/docs/guides/platform/database-size#disk-management"}),(0,n.jsx)(K.P,{visible:!0,type:"default",title:"Disk Management has moved",description:"Disk configuration is now managed alongside Project Compute on the new Compute and Disk page.",actions:(0,n.jsx)(M.z,{type:"default",asChild:!0,children:(0,n.jsx)(m(),{href:"/project/".concat(ep,"/settings/compute-and-disk"),children:"Go to Compute and Disk"})})})]}):"free"===eO?(0,n.jsxs)("div",{id:"disk-management",children:[(0,n.jsx)(v.p,{title:"Disk Management",docsUrl:"https://supabase.com/docs/guides/platform/database-size#disk-management"}),(0,n.jsxs)(D.bZ,{children:[(0,n.jsx)(l.Z,{}),(0,n.jsx)(D.Cd,{children:"Disk size configuration is not available for projects on the Free Plan"}),(0,n.jsxs)(D.X,{children:[(0,n.jsx)("p",{children:"If you are intending to use more than 500MB of disk space, then you will need to upgrade to at least the Pro Plan."}),(0,n.jsx)(M.z,{asChild:!0,type:"default",className:"mt-3",children:(0,n.jsx)(m(),{target:"_blank",rel:"noreferrer",href:"/org/".concat(null==ex?void 0:ex.slug,"/billing?panel=subscriptionPlan"),children:"Upgrade plan"})})]})]})]}):(0,n.jsxs)("div",{id:"disk-management","data-sentry-component":"DiskManagementPanelForm","data-sentry-source-file":"DiskManagementPanelForm.tsx",children:[(0,n.jsx)(v.p,{title:"Disk Management",docsUrl:"https://supabase.com/docs/guides/platform/database-size#disk-management","data-sentry-element":"FormHeader","data-sentry-source-file":"DiskManagementPanelForm.tsx"}),(0,n.jsx)(A.l0,{...eq,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"DiskManagementPanelForm.tsx",children:(0,n.jsx)("form",{onSubmit:eq.handleSubmit(se),children:(0,n.jsxs)("div",{className:"-space-y-px",children:[(0,n.jsxs)(Z.Zb,{className:"bg-surface-100 rounded-b-none","data-sentry-element":"Card","data-sentry-source-file":"DiskManagementPanelForm.tsx",children:[(0,n.jsxs)(Z.aY,{className:"transition-all duration-500 ease-in-out py-10 flex flex-col gap-10 px-8","data-sentry-element":"CardContent","data-sentry-source-file":"DiskManagementPanelForm.tsx",children:[(0,n.jsx)(A.Wi,{name:"storageType",control:eq.control,render:e=>{let{field:s}=e;return(0,n.jsx)(E.E,{layout:"horizontal",label:"Storage type",children:(0,n.jsx)(A.NI,{children:(0,n.jsxs)(R.W,{className:"flex flex-wrap gap-3",...s,onValueChange:async e=>{s.onChange(e),await eq.trigger("provisionedIOPS"),await eq.trigger("totalSize")},defaultValue:s.value,disabled:e4,children:[(0,n.jsx)(A.xJ,{asChild:!0,children:(0,n.jsx)(A.NI,{children:(0,n.jsx)(R.Y,{className:"grow p-3 px-5",disabled:e4,value:"gp3",showIndicator:!1,label:(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,n.jsx)("span",{className:"text-sm",children:"General Purpose SSD"})," ",(0,n.jsx)("div",{children:(0,n.jsx)(F.C,{variant:"outline",className:"font-mono bg-alternative bg-opacity-100",children:"gp3"})})]}),(0,n.jsx)("p",{className:"text-foreground-light",children:"gp3 provides a balance between price and performance"})]})})})}),(0,n.jsx)(A.xJ,{asChild:!0,children:(0,n.jsx)(A.NI,{children:(0,n.jsx)(R.Y,{className:"grow p-3 px-5",disabled:e4,value:"io2",showIndicator:!1,label:(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,n.jsx)("span",{className:"text-sm",children:"Provisioned IOPS SSD"})," ",(0,n.jsx)("div",{children:(0,n.jsx)(F.C,{variant:"outline",className:"font-mono bg-alternative bg-opacity-100",children:"io2"})})]}),(0,n.jsx)("p",{className:"text-foreground-light",children:"io2 offers high IOPS for mission-critical applications."})]})})})})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"DiskManagementPanelForm.tsx"}),(0,n.jsx)(A.Wi,{control:eq.control,name:"provisionedIOPS",render:e=>{var s;let{field:t}=e;return(0,n.jsx)(E.E,{layout:"horizontal",label:"IOPS",description:(0,n.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,n.jsxs)("div",{children:["io2"===eQ?(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsxs)("span",{children:["IOPS must be"," ",e$>=8?"between ".concat(e8," and ").concat(e6.toLocaleString()," based on your disk size."):"at least ".concat(e8)]}),(0,n.jsxs)(T.u,{children:[(0,n.jsx)(T.aJ,{asChild:!0,children:(0,n.jsx)(d.Z,{size:14,className:"transition hover:text-foreground"})}),(0,n.jsxs)(T._v,{side:"bottom",children:["For io2 storage type, min IOPS is at ",e8,", while max IOPS is at 1000 * disk size in GB or"," ",X.nG[X.Hb.IO2].max.toLocaleString(),", whichever is lower"]})]})]}):(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsxs)("span",{children:["IOPS must be"," ",e$>=8?"between ".concat(e8.toLocaleString()," and ").concat(e6.toLocaleString()," based on your disk size."):"at least ".concat(e8.toLocaleString())]}),(0,n.jsxs)(T.u,{children:[(0,n.jsx)(T.aJ,{asChild:!0,children:(0,n.jsx)(d.Z,{size:14,className:"transition hover:text-foreground"})}),(0,n.jsxs)(T._v,{side:"bottom",className:"w-64",children:["For gp3 storage type, min IOPS is at ",e8," while max IOPS is at 500 * disk size in GB or"," ",X.nG[X.Hb.GP3].max.toLocaleString(),", whichever is lower"]})]})]}),!eq.formState.errors.provisionedIOPS&&t.value>eF&&(0,n.jsxs)("p",{children:["Note: Final usable IOPS will be at"," ",(0,n.jsx)("span",{className:"text-foreground",children:eF.toLocaleString()})," ","based on your current compute size of ",null==eR?void 0:eR.name]})]}),!eq.formState.errors.provisionedIOPS&&(0,n.jsx)(J.fl,{isDirty:void 0!==eq.formState.dirtyFields.provisionedIOPS,oldIOPS:null!=ez?ez:0,newIOPS:t.value,oldStorageType:null===(s=eq.formState.defaultValues)||void 0===s?void 0:s.storageType,newStorageType:eq.getValues("storageType")})]}),labelOptional:"Input/output operations per second. Higher IOPS is suitable for applications requiring high throughput.",children:(0,n.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,n.jsxs)("div",{className:"flex -space-x-px",children:[(0,n.jsx)(A.NI,{children:(0,n.jsx)(B.I,{id:"provisionedIOPS",type:"number",className:"flex-grow font-mono rounded-r-none max-w-32",...t,disabled:e4,onChange:e=>{eW("provisionedIOPS",e.target.valueAsNumber,{shouldDirty:!0,shouldValidate:!0})}})}),(0,n.jsx)("div",{className:"border border-strong bg-surface-300 rounded-r-md px-3 flex items-center justify-center",children:(0,n.jsx)("span",{className:"text-foreground-lighter text-xs font-mono",children:"IOPS"})})]}),(0,n.jsx)(H.G,{show:(eQ!==ek||"gp3"===eQ&&t.value!==ez)&&!eK.errors.provisionedIOPS,beforePrice:Number(sa.oldPrice),afterPrice:Number(sa.newPrice)})]})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"DiskManagementPanelForm.tsx"}),(0,n.jsx)(i.M,{initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-source-file":"DiskManagementPanelForm.tsx",children:"gp3"===eq.getValues("storageType")&&(0,n.jsx)(r.E.div,{initial:{opacity:0,x:-4,height:0},animate:{opacity:1,x:0,height:"auto"},exit:{opacity:0,x:-4,height:0},transition:{duration:.1},style:{overflow:"hidden"},children:(0,n.jsx)(A.Wi,{name:"throughput",control:eJ,render:e=>{var s,t;let{field:a}=e;return(0,n.jsx)(E.E,{label:"Throughput (MB/s)",layout:"horizontal",description:(0,n.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsxs)("span",{children:["Throughput must be between ",e9.toLocaleString()," ","and ",null==e7?void 0:e7.toLocaleString()," MB/s based on your IOPS."]}),(0,n.jsxs)(T.u,{children:[(0,n.jsx)(T.aJ,{asChild:!0,children:(0,n.jsx)(d.Z,{size:14,className:"transition hover:text-foreground"})}),(0,n.jsx)(T._v,{side:"bottom",className:"w-64",children:"Min throughput is at 125MB/s, while max throughput is at 0.25MB/s * IOPS or 1,000, whichever is lower"})]})]}),!eq.formState.errors.throughput&&void 0!==a.value&&a.value>eT&&(0,n.jsxs)("p",{children:["Note: Final usable throughput will be at"," ",(0,n.jsx)("span",{className:"text-foreground",children:eT.toFixed(0)})," ","MB/s based on your current compute size of"," ",null==eR?void 0:eR.name]})]}),!eq.formState.errors.throughput&&(0,n.jsx)(J.l7,{isDirty:void 0!==eq.formState.dirtyFields.throughput,oldThroughput:null!=e_?e_:0,newThroughput:null!==(t=a.value)&&void 0!==t?t:0,oldStorageType:null===(s=eq.formState.defaultValues)||void 0===s?void 0:s.storageType,newStorageType:eq.getValues("storageType")})]}),children:(0,n.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,n.jsxs)("div",{className:"flex -space-x-px",children:[(0,n.jsx)(A.NI,{children:(0,n.jsx)(B.I,{type:"number",...a,onChange:e=>{eW("throughput",e.target.valueAsNumber,{shouldDirty:!0,shouldValidate:!0})},className:"flex-grow font-mono rounded-r-none max-w-32",disabled:e4||"io2"===eQ})}),(0,n.jsx)("div",{className:"border border-strong bg-surface-300 rounded-r-md px-3 flex items-center justify-center",children:(0,n.jsx)("span",{className:"text-foreground-lighter text-xs font-mono",children:"MB/s"})})]}),(0,n.jsx)(H.G,{show:eK.isDirty&&eK.dirtyFields.throughput&&!eK.errors.throughput,beforePrice:Number(so.oldPrice),afterPrice:Number(so.newPrice)})]})})}})},"throughPutContainer")})]}),(0,n.jsx)(O.Z,{"data-sentry-element":"Separator","data-sentry-source-file":"DiskManagementPanelForm.tsx"}),(0,n.jsxs)(Z.aY,{className:"py-10 px-8","data-sentry-element":"CardContent","data-sentry-source-file":"DiskManagementPanelForm.tsx",children:[(0,n.jsx)(A.Wi,{name:"totalSize",control:eJ,render:e=>{let{field:s}=e;return(0,n.jsx)(E.E,{label:"Disk Size",layout:"horizontal",description:(0,n.jsxs)(n.Fragment,{children:[e5>0&&"Your plan includes ".concat(e5," GB of disk size for ").concat(eQ,"."),s.value<eI&&(0,n.jsx)(L.J,{className:"mt-2",type:"default",title:"Reducing your project's disk size?",description:(0,n.jsx)(G.U,{className:"[&>p]:!leading-normal",content:'Your disk size will automatically "right-size" when you [upgrade your project](/project/'.concat(ep,"/settings/infrastructure).")}),children:(0,n.jsx)(j.G,{abbrev:!1,href:"https://supabase.com/docs/guides/platform/database-size#reducing-disk-size"})})]}),children:(0,n.jsxs)("div",{className:"mt-1 relative flex gap-2 items-center",children:[(0,n.jsxs)("div",{className:"flex -space-x-px max-w-48",children:[(0,n.jsx)(A.NI,{children:(0,n.jsx)(B.I,{type:"number",step:"1",...s,disabled:e4,className:"flex-grow font-mono rounded-r-none",onWheel:e=>e.currentTarget.blur(),onChange:e=>{eW("totalSize",e.target.valueAsNumber,{shouldDirty:!0,shouldValidate:!0}),eX("provisionedIOPS"),eX("throughput")},min:e5})}),(0,n.jsx)("div",{className:"border border-strong bg-surface-300 rounded-r-md px-3 flex items-center justify-center",children:(0,n.jsx)("span",{className:"text-foreground-lighter text-xs font-mono",children:"GB"})})]}),(0,n.jsx)(i.M,{initial:!1,children:e2&&(0,n.jsx)(r.E.div,{initial:{opacity:0,scale:.95,x:-2},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.95,x:-2},transition:{duration:.15},children:(0,n.jsx)(M.z,{htmlType:"button",type:"default",size:"small",className:"px-2",onClick:()=>eq.resetField("totalSize"),children:(0,n.jsx)(c.Z,{className:"h-4 w-4","aria-hidden":"true"})})},"reset-disksize")}),(0,n.jsx)(H.G,{beforePrice:Number(sn.oldPrice),afterPrice:Number(sn.newPrice),show:eK.isDirty&&!eK.errors.totalSize&&sn.oldPrice!==sn.newPrice})]})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"DiskManagementPanelForm.tsx"}),(0,n.jsxs)("div",{className:"grid grid-cols-12 gap-10",children:[(0,n.jsx)("div",{className:"col-span-4"}),(0,n.jsxs)("div",{className:"col-span-8 space-y-6 mt-6",children:[(0,n.jsx)(g.Z,{form:eq,"data-sentry-element":"DiskSpaceBar","data-sentry-source-file":"DiskManagementPanelForm.tsx"}),(0,n.jsx)(J.hd,{isDirty:void 0!==eq.formState.dirtyFields.totalSize,totalSize:1.25*eI,usedSize:eV,newTotalSize:1.25*e$,oldStorageType:null===(en=eq.formState.defaultValues)||void 0===en?void 0:en.storageType,newStorageType:eq.getValues("storageType"),"data-sentry-element":"DiskManagementDiskSizeReadReplicas","data-sentry-source-file":"DiskManagementPanelForm.tsx"})]})]})]})]}),eM?(0,n.jsx)(Z.Zb,{className:"px-2 rounded-none",children:(0,n.jsx)(Z.aY,{className:"py-3 flex gap-3 px-3 items-center",children:(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("p",{className:"text-foreground-lighter text-sm p-0",children:"Disk configuration changes have been requested"}),(0,n.jsx)("p",{className:"text-sm",children:"The requested changes will be applied to your disk shortly"})]})})}):(0,n.jsx)(W.D,{}),(0,n.jsx)(Q.H,{"data-sentry-element":"SpendCapDisabledSection","data-sentry-source-file":"DiskManagementPanelForm.tsx"}),(0,n.jsx)(Z.Zb,{className:"bg-surface-100 rounded-t-none","data-sentry-element":"Card","data-sentry-source-file":"DiskManagementPanelForm.tsx",children:(0,n.jsxs)(Z.aY,{className:"flex items-center pb-0 py-3 px-8 gap-3 justify-end","data-sentry-element":"CardContent","data-sentry-source-file":"DiskManagementPanelForm.tsx",children:[(0,n.jsx)(V.C,{formState:eK,"data-sentry-element":"FormFooterChangeBadge","data-sentry-source-file":"DiskManagementPanelForm.tsx"}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(M.z,{type:"default",onClick:()=>eq.reset(),disabled:!eq.formState.isDirty,"data-sentry-element":"Button","data-sentry-source-file":"DiskManagementPanelForm.tsx",children:"Cancel"}),(0,n.jsx)(q.B,{loading:eY,form:eq,numReplicas:eS.length,isDialogOpen:ef,disabled:e4,onSubmit:se,setIsDialogOpen:eg,buttonSize:"tiny","data-sentry-element":"DiskManagementReviewAndSubmitDialog","data-sentry-source-file":"DiskManagementPanelForm.tsx"})]})]})})]})})})]})}var ee=t(60844),es=t.n(ee),et=t(5394),en=t(5529),ea=t(59461),eo=t(18186),ei=t(63621),er=t(11907),el=t(98502),ed=t(36457),ec=t(64618),eu=t(6464),em=t(7324);async function ex(e){let{ref:s,pool_mode:t,default_pool_size:n}=e;if(!s)return console.error("Project ref is required");let{data:a,error:o}=await (0,eu.r$)("/platform/projects/{ref}/config/supavisor",{params:{path:{ref:s}},body:{default_pool_size:n,pool_mode:t}});return o&&(0,eu.S3)(o),a}let ep=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,ed.NL)();return(0,ec.D)(e=>ex(e),{async onSuccess(s,t,a){let{ref:o}=t;await n.invalidateQueries(em.A.poolingConfiguration(o)),await (null==e?void 0:e(s,t,a))},async onError(e,t,n){void 0===s?h.Am.error("Failed to update pooling configuration: ".concat(e.message)):s(e,t,n)},...t})};var eh=t(28622),ef=t(34653);let eg=(0,x.createContext)(function(){let e=(0,eh.sj)({usePoolerConnection:!0,setUsePoolerConnection:s=>{e.usePoolerConnection=s},showPoolingModeHelper:!1,setShowPoolingModeHelper:s=>{e.showPoolingModeHelper=s}});return e}());function ey(e){let s=(0,x.useContext)(eg);return(0,ef.R)(s,e)}var ej=t(85818);let ev={ci_nano:{maxClientConn:200,poolSize:15},ci_micro:{maxClientConn:200,poolSize:15},ci_small:{maxClientConn:400,poolSize:15},ci_medium:{maxClientConn:600,poolSize:15},ci_large:{maxClientConn:800,poolSize:20},ci_xlarge:{maxClientConn:1e3,poolSize:20},ci_2xlarge:{maxClientConn:1500,poolSize:25},ci_4xlarge:{maxClientConn:3e3,poolSize:32},ci_8xlarge:{maxClientConn:6e3,poolSize:64},ci_12xlarge:{maxClientConn:9e3,poolSize:96},ci_16xlarge:{maxClientConn:12e3,poolSize:128}},eb="connection-pooling-form",ew=et.ZP.union([et.ZP.number().positive().int(),et.ZP.string().min(1).pipe(et.ZP.coerce.number().positive().int()),et.ZP.string().max(0,"The field accepts only a number").transform(e=>null),et.ZP.null()]),eN=et.ZP.object({default_pool_size:ew,pool_mode:et.ZP.union([et.ZP.literal("transaction"),et.ZP.literal("session")]),max_client_conn:ew}),eS=()=>{var e,s,t,i,r;let{ref:l}=(0,f.UO)(),{project:d}=(0,y.d2)(),c=ey(),{data:u}=(0,P.F)({projectRef:l}),m=null==u?void 0:u.selected_addons.find(e=>"compute_instance"===e.type),g=ev[null!==(e=null==m?void 0:m.variant.identifier)&&void 0!==e?e:(null==d?void 0:d.infra_compute_size)==="nano"?"ci_nano":"ci_micro"],v=null!==(s=g.poolSize)&&void 0!==s?s:15,b=null!==(t=g.maxClientConn)&&void 0!==t?t:200,w=null!==(r=null!==(i=null==m?void 0:m.variant.name)&&void 0!==i?i:es()(null==d?void 0:d.infra_compute_size))&&void 0!==r?r:"Micro",{data:N,error:S,isLoading:C,isError:z,isSuccess:_}=(0,el.Y)({projectRef:l}),{data:I}=(0,er.E3)({projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString}),M=null==N?void 0:N.find(e=>"PRIMARY"===e.database_type),Z=(null==M?void 0:M.pool_mode)===null,R=(0,k.Xo)(o.KA.UPDATE,"projects",{resource:{project_id:null==d?void 0:d.id}}),T=(0,p.cI)({resolver:(0,a.F)(eN),defaultValues:{pool_mode:null==M?void 0:M.pool_mode,default_pool_size:null==M?void 0:M.default_pool_size,max_client_conn:null==M?void 0:M.max_client_conn}}),{mutate:L,isLoading:E}=ep({onSuccess:e=>{e&&T.reset({pool_mode:e.pool_mode,default_pool_size:e.default_pool_size,max_client_conn:null==M?void 0:M.max_client_conn}),h.Am.success("Successfully saved settings")}}),V=async e=>l?N?void L({ref:l,default_pool_size:e.default_pool_size,pool_mode:e.pool_mode}):console.error("Pooling info required"):console.error("Project ref is required");return(0,x.useEffect)(()=>{_&&T.reset({pool_mode:null==M?void 0:M.pool_mode,default_pool_size:null==M?void 0:M.default_pool_size,max_client_conn:null==M?void 0:M.max_client_conn})},[_]),(0,n.jsx)("section",{id:"connection-pooler","data-sentry-component":"ConnectionPooling","data-sentry-source-file":"ConnectionPooling.tsx",children:(0,n.jsxs)(eo.Z,{className:"!mb-0",title:(0,n.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsx)("p",{children:Z?"Connection Pooling is not available for this project":"Connection pooling configuration"}),(0,n.jsx)(F.C,{children:"Supavisor"})]}),(0,n.jsx)(j.G,{href:"https://supabase.com/docs/guides/database/connecting-to-postgres#connection-pooler"})]}),footer:(0,n.jsx)(ea.i,{form:eb,isSubmitting:E,hasChanges:T.formState.isDirty,handleReset:()=>T.reset(),helper:R?void 0:"You need additional permissions to update connection pooling settings"}),"data-sentry-element":"Panel","data-sentry-source-file":"ConnectionPooling.tsx",children:[C&&(0,n.jsxs)(eo.Z.Content,{className:"space-y-8",children:[Array.from({length:4}).map((e,s)=>(0,n.jsxs)(x.Fragment,{children:[(0,n.jsxs)("div",{className:"grid gap-2 items-center md:grid md:grid-cols-12 md:gap-x-4 w-full",children:[(0,n.jsx)(ei.Z,{className:"h-4 w-1/3 col-span-4",delayIndex:s}),(0,n.jsx)(ei.Z,{className:"h-8 w-full col-span-8",delayIndex:s})]}),(0,n.jsx)(O.Z,{})]},s)),(0,n.jsx)(ei.Z,{className:"h-8 w-full"})]}),z&&(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)(en.Z,{error:S,subject:"Failed to retrieve pooling configuration"})}),_&&(0,n.jsxs)(n.Fragment,{children:[Z&&(0,n.jsx)("p",{children:"Please start a new project to enable this feature."}),(0,n.jsx)(A.l0,{...T,children:(0,n.jsxs)("form",{id:eb,className:"space-y-6 w-full px-8 py-8",onSubmit:T.handleSubmit(V),children:[(0,n.jsx)(A.Wi,{control:T.control,name:"pool_mode",render:e=>{let{field:s}=e;return(0,n.jsxs)(A.xJ,{className:"grid gap-2 md:grid md:grid-cols-12 space-y-0",children:[(0,n.jsx)(A.lX,{className:"flex flex-col space-y-2 col-span-4 text-sm justify-center text-foreground-light",children:"Pool Mode"}),(0,n.jsx)(A.NI,{className:"col-span-8",children:(0,n.jsxs)(ej.Z,{disabled:(null==M?void 0:M.pool_mode)==="transaction",value:s.value,className:"w-full",onChange:e=>s.onChange(e),children:[(0,n.jsxs)(ej.Z.Option,{label:"Transaction",value:"transaction",children:[(0,n.jsx)("p",{children:"Transaction mode"}),(0,n.jsx)("p",{className:"text-xs text-foreground-lighter",children:"Connection is assigned to the client for the duration of a transaction. Some session-based Postgres features such as prepared statements are not available with this option."})]},"transaction"),(0,n.jsxs)(ej.Z.Option,{label:"Session",value:"session",children:[(0,n.jsx)("p",{children:"Session mode"}),(0,n.jsx)("p",{className:"text-xs text-foreground-lighter",children:"When a new client connects, a connection is assigned to the client until it disconnects. All Postgres features can be used with this option."})]},"session")]})}),(null==M?void 0:M.pool_mode)==="transaction"&&(0,n.jsx)(A.pf,{className:"col-start-5 col-span-8 flex flex-col gap-y-2",children:(0,n.jsxs)(D.bZ,{children:[(0,n.jsx)(D.Cd,{className:"text-foreground",children:"Pool mode is permanently set to Transaction on port 6543"}),(0,n.jsx)(D.X,{children:"You can use Session mode by connecting to the pooler on port 5432 instead"})]})}),(null==M?void 0:M.pool_mode)==="session"&&(0,n.jsx)(n.Fragment,{children:"transaction"===s.value?(0,n.jsx)(A.pf,{className:"col-start-5 col-span-8 flex flex-col gap-y-2",children:(0,n.jsxs)(D.bZ,{children:[(0,n.jsx)(D.Cd,{className:"text-foreground",children:"Pool mode will be set to transaction permanently on port 6543"}),(0,n.jsx)(D.X,{children:"This will take into effect once saved. You can use session mode by pointing the pooler connection to use port 5432."})]})}):(0,n.jsx)(A.pf,{className:"col-start-5 col-span-8 flex flex-col gap-y-2",children:(0,n.jsxs)(D.bZ,{children:[(0,n.jsx)(D.Cd,{className:"text-foreground",children:"Set to transaction mode to use both pooling modes concurrently"}),(0,n.jsx)(D.X,{children:"Session mode can be used concurrently with transaction mode by using 5432 for session and 6543 for transaction. However, by configuring the pooler mode to session here, you will not be able to use transaction mode at the same time."})]})})}),(0,n.jsx)(A.pf,{className:"col-start-5 col-span-8 flex flex-col gap-y-2",children:(0,n.jsxs)("p",{children:["Specify when a connection can be returned to the pool."," ",(0,n.jsx)("span",{tabIndex:0,onClick:()=>c.setShowPoolingModeHelper(!0),className:"cursor-pointer underline underline-offset-2",children:"Learn more about pool modes"}),"."]})}),(0,n.jsx)(A.zG,{className:"col-start-5 col-span-8"})]})}}),(0,n.jsx)(A.Wi,{control:T.control,name:"default_pool_size",render:e=>{var s;let{field:t}=e;return(0,n.jsxs)(A.xJ,{className:"grid gap-2 md:grid md:grid-cols-12 space-y-0",children:[(0,n.jsx)(A.lX,{className:"flex flex-col space-y-2 col-span-4 text-sm justify-center text-foreground-light",children:"Pool Size"}),(0,n.jsx)(A.NI,{className:"col-span-8",children:(0,n.jsx)(B.I,{...t,type:"number",className:"w-full",value:t.value||void 0,placeholder:null===t.value?"".concat(v):""})}),void 0!==I&&Number(null!==(s=T.getValues("default_pool_size"))&&void 0!==s?s:15)>.8*I.maxConnections&&(0,n.jsx)("div",{className:"col-start-5 col-span-8",children:(0,n.jsxs)(D.bZ,{variant:"warning",children:[(0,n.jsxs)(D.Cd,{className:"text-foreground",children:["Pool size is greater than 80% of the max connections (",I.maxConnections,") on your database"]}),(0,n.jsx)(D.X,{children:"This may result in instability and unreliability with your database connections."})]})}),(0,n.jsxs)(A.pf,{className:"col-start-5 col-span-8",children:["The maximum number of connections made to the underlying Postgres cluster, per user+db combination. Pool size has a default of ",v," based on your compute size of ",w,"."]}),(0,n.jsxs)(A.pf,{className:"col-start-5 col-span-8",children:["Please refer to our"," ",(0,n.jsx)("a",{href:"https://supabase.com/docs/guides/database/connection-management#configuring-supavisors-pool-size",target:"_blank",rel:"noreferrer",className:"underline",children:"documentation"})," ","to find out more."]}),(0,n.jsx)(A.zG,{className:"col-start-5 col-span-8"})]})}}),(0,n.jsx)(A.Wi,{disabled:!0,control:T.control,name:"max_client_conn",render:e=>{let{field:s}=e;return(0,n.jsxs)(A.xJ,{className:"grid gap-2 md:grid md:grid-cols-12 space-y-0",children:[(0,n.jsx)(A.lX,{className:"flex flex-col space-y-2 col-span-4 text-sm justify-center text-foreground-light",children:"Max Client Connections"}),(0,n.jsx)(A.NI,{className:"col-span-8",children:(0,n.jsx)(B.I,{...s,value:s.value||void 0,className:"w-full",placeholder:null===s.value?"".concat(b):""})}),(0,n.jsxs)(A.pf,{className:"col-start-5 col-span-8",children:["The maximum number of concurrent client connections allowed. This value is fixed at ",b," based on your compute size of ",w," ","and cannot be changed."]}),(0,n.jsxs)(A.pf,{className:"col-start-5 col-span-8",children:["Please refer to our"," ",(0,n.jsx)("a",{href:"https://supabase.com/docs/guides/database/connection-management#configuring-supavisors-pool-size",target:"_blank",rel:"noreferrer",className:"underline",children:"documentation"})," ","to find out more."]}),(0,n.jsx)(A.zG,{className:"col-start-5 col-span-8"})]})}})]})}),(0,n.jsx)("div",{className:"border-muted border-t"})]})]})})};var eC=t(98601),eP=t(44735),ek=t(11024),ez=t(20736),e_=t(359),eI=t(87696),eM=t(28894);let eD=e=>["projects",e,"network-restrictions"];async function eA(e,s){let{projectRef:t}=e;if(!t)throw Error("projectRef is required");let{data:n,error:a}=await (0,eu.U2)("/v1/projects/{ref}/network-restrictions",{params:{path:{ref:t}},signal:s});if(a){var o;if((null==a?void 0:a.code)===400&&(null==a?void 0:null===(o=a.message)||void 0===o?void 0:o.includes("not allowed to set up network restrictions")))return{entitlement:"disallowed",config:{dbAllowedCidrs:[]},status:""};(0,eu.S3)(a)}return n}let eZ=function(e){let{projectRef:s}=e,{enabled:t=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,eM.a)(eD(s),e=>{let{signal:t}=e;return eA({projectRef:s},t)},{enabled:t&&void 0!==s,...n})};var eR=t(14500),eF=t(42155),eT=t(19540),eB=t(51571),eO=t(13064);async function eL(e){let{projectRef:s,dbAllowedCidrs:t,dbAllowedCidrsV6:n}=e;if(!s)throw Error("projectRef is required");let{data:a,error:o}=await (0,eu.v_)("/v1/projects/{ref}/network-restrictions/apply",{params:{path:{ref:s}},body:{dbAllowedCidrs:t,dbAllowedCidrsV6:n}});return o&&(0,eu.S3)(o),a}let eE=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,ed.NL)();return(0,ec.D)(e=>eL(e),{async onSuccess(s,t,a){let{projectRef:o}=t;await n.invalidateQueries(eD(o)),await (null==e?void 0:e(s,t,a))},async onError(e,t,n){void 0===s?h.Am.error("Failed to apply network restrictions: ".concat(e.message)):s(e,t,n)},...t})};var eV=t(51576);let eG=[eV.IPv4CidrRange.fromCidr("10.0.0.0/8"),eV.IPv4CidrRange.fromCidr("172.16.0.0/12"),eV.IPv4CidrRange.fromCidr("192.168.0.0/16")],eY=[eV.IPv6CidrRange.fromCidr("fc00::/7")],eU=e=>{if(e.includes("/"))return!1;let[s]=eV.Validator.isValidIPv4String(e),[t]=eV.Validator.isValidIPv6String(e);return s||t},eq=(e,s)=>{try{if("IPv4"===e){let e=eV.IPv4CidrRange.fromCidr("".concat(s,"/32"));return eG.map(s=>e.inside(s)).includes(!0)}{let e=eV.IPv6CidrRange.fromCidr("".concat(s,"/128"));return eY.map(s=>e.inside(s)).includes(!0)}}catch(e){return!1}},eH=e=>"".concat("0".repeat(4-e.length)).concat(e),eW=(e,s)=>{if("IPv4"===e)try{let e=eV.IPv4CidrRange.fromCidr(s),t=e.getFirst().octets.join("."),n=e.getLast().octets.join(".");return{start:t,end:n}}catch(e){return}else try{let e=eV.IPv6CidrRange.fromCidr(s),t=e.getFirst().hexadecatet.toString().split(",").map(eH).join(":"),n=e.getLast().hexadecatet.toString().split(",").map(eH).join(":");return{start:t,end:n}}catch(e){return}},eX=e=>{let[s]=eV.Validator.isValidIPv4String(e.split("/")[0]);if(s){let s=eV.IPv4CidrRange.fromCidr(e),t=s.getFirst().toString(),n=s.getPrefix().toString();return"".concat(t,"/").concat(n)}{let s=eV.IPv6CidrRange.fromCidr(e),t=(0,eV.collapseIPv6Number)(s.getFirst().toString()),n=s.getPrefix().toString();return"".concat(t,"/").concat(n)}};var eJ=e=>{var s,t,a,o;let{type:i,hasOverachingRestriction:r,onClose:l}=e,{ref:c}=(0,f.UO)(),{data:u}=eZ({projectRef:c}),m=null!==(a=null==u?void 0:null===(s=u.config)||void 0===s?void 0:s.dbAllowedCidrs)&&void 0!==a?a:[],x=null!==(o=null==u?void 0:null===(t=u.config)||void 0===t?void 0:t.dbAllowedCidrsV6)&&void 0!==o?o:[],p=m.concat(x),{mutate:g,isLoading:y}=eE({onSuccess:()=>{h.Am.success("Successfully added restriction"),l()}}),j=async e=>{if(!c)return console.error("Project ref is required");let s="".concat(e.ipAddress,"/").concat(e.cidrBlockSize),t=eX(s);if(p.includes(s)||p.includes(t))return(0,h.Am)("The address ".concat(s," is already restricted"));r?g({projectRef:c,dbAllowedCidrs:"IPv4"===i?[t]:[],dbAllowedCidrsV6:"IPv6"===i?[t]:[]}):g({projectRef:c,dbAllowedCidrs:"IPv4"===i?[...m,t]:m,dbAllowedCidrsV6:"IPv6"===i?[...x,t]:x})};return(0,n.jsx)(eF.Z,{hideFooter:!0,size:"medium",visible:void 0!==i,onCancel:l,header:"Add a new ".concat(i," restriction"),"data-sentry-element":"Modal","data-sentry-component":"AddRestrictionModal","data-sentry-source-file":"AddRestrictionModal.tsx",children:(0,n.jsx)(eT.Z,{validateOnBlur:!0,id:"add-restriction-form",className:"!border-t-0",initialValues:{ipAddress:"",cidrBlockSize:"IPv4"===i?"32":"128"},validate:e=>{let s={};if(void 0===i)return s;let{ipAddress:t,cidrBlockSize:n}=e,a="IPv4"===i?n<0||n>32:n<0||n>128;if((0===n.length||a)&&(s.cidrBlockSize="Size has to be between 0 to ".concat("IPv4"===i?32:128)),!eU(t))return s.ipAddress="Please enter a valid IP address",s;try{eq(i,t)&&(s.ipAddress="Private IP addresses are not supported")}catch(e){s.ipAddress=e.message}return s},onSubmit:j,"data-sentry-element":"Form","data-sentry-source-file":"AddRestrictionModal.tsx",children:e=>{var s,t;let{values:a}=e,o=!!(void 0!==i&&eU(a.ipAddress))&&eq(i,a.ipAddress),r=""!==a.cidrBlockSize&&("IPv4"===i&&a.cidrBlockSize>=0&&a.cidrBlockSize<=32||"IPv6"===i&&a.cidrBlockSize>=0&&a.cidrBlockSize<=128),c="IPv4"===i?Math.pow(2,32-(null!==(s=null==a?void 0:a.cidrBlockSize)&&void 0!==s?s:0)):Math.pow(2,128-(null!==(t=null==a?void 0:a.cidrBlockSize)&&void 0!==t?t:0)),u=void 0!==i?eW(i,"".concat(a.ipAddress,"/").concat(a.cidrBlockSize)):void 0,m=r&&!o&&void 0!==u,x=m?eX("".concat(a.ipAddress,"/").concat(a.cidrBlockSize)):"".concat(a.ipAddress,"/").concat(a.cidrBlockSize);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(eF.Z.Content,{className:"space-y-4",children:[(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"This will add an IP address range to a list of allowed ranges that can access your database."}),(0,n.jsx)(eO.Z,{title:"Note: Restrictions only apply to direct connections to your database and Supavisor",description:"They do not currently apply to APIs offered over HTTPS, such as PostgREST, Storage, or Authentication.",urlLabel:"Learn more",url:"https://supabase.com/docs/guides/platform/network-restrictions#limitations"}),(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsx)("div",{className:"w-[55%]",children:(0,n.jsx)(eB.Z,{label:"".concat(i," address"),id:"ipAddress",name:"ipAddress",placeholder:"IPv4"===i?"0.0.0.0":"::0"})}),(0,n.jsx)("div",{className:"flex-grow",children:(0,n.jsx)(eB.Z,{label:(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("p",{children:"CIDR Block Size"}),(0,n.jsxs)(T.u,{children:[(0,n.jsx)(T.aJ,{children:(0,n.jsx)(d.Z,{size:"14",strokeWidth:2})}),(0,n.jsxs)(T._v,{side:"bottom",className:"w-80",children:["Classless inter-domain routing (CIDR) notation is the notation used to identify networks and hosts in the networks. The block size tells us how many bits we need to take for the network prefix, and is a value between 0 to"," ","IPv4"===i?32:128,"."]})]})]}),id:"cidrBlockSize",name:"cidrBlockSize",type:"number",placeholder:"IPv4"===i?"32":"128",min:0,max:"IPv4"===i?32:128})})]})]}),(0,n.jsx)(eF.Z.Separator,{}),m?(0,n.jsxs)(eF.Z.Content,{className:"space-y-1",children:[(0,n.jsxs)("p",{className:"text-sm",children:["The address range ",(0,n.jsx)("code",{className:"text-xs",children:x})," will be restricted"]}),(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:["Selected address space: ",(0,n.jsx)("code",{className:"text-xs",children:u.start})," to"," ",(0,n.jsx)("code",{className:"text-xs",children:u.end})," "]}),(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:["Number of addresses: ",c]})]}):(0,n.jsx)(eF.Z.Content,{children:(0,n.jsx)("div",{className:"h-[68px] flex items-center",children:(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"A summary of your restriction will be shown here after entering a valid IP address and CIDR block size. IP addresses will also be normalized."})})}),(0,n.jsx)(eF.Z.Separator,{}),(0,n.jsxs)(eF.Z.Content,{className:"flex items-center justify-end space-x-2",children:[(0,n.jsx)(M.z,{type:"default",disabled:y,onClick:()=>l(),children:"Cancel"}),(0,n.jsx)(M.z,{htmlType:"submit",loading:y,disabled:y,children:"Save restriction"})]})]})}})})},eK=t(39303),eQ=e=>{let{visible:s,onClose:t}=e,{ref:a}=(0,eK.UO)(),{mutate:o,isLoading:i}=eE({onSuccess:()=>t()}),r=async()=>{if(!a)return console.error("Project ref is required");o({projectRef:a,dbAllowedCidrs:["0.0.0.0/0"],dbAllowedCidrsV6:["::/0"]})};return(0,n.jsxs)(eF.Z,{closable:!0,hideFooter:!0,size:"small",visible:s,onCancel:t,header:"Allow access from all IP addresses","data-sentry-element":"Modal","data-sentry-component":"AllowAllModal","data-sentry-source-file":"AllowAllModal.tsx",children:[(0,n.jsx)(eF.Z.Content,{className:"space-y-4","data-sentry-element":"unknown","data-sentry-source-file":"AllowAllModal.tsx",children:(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"This will allow any IP address to access your project's database. Are you sure?"})}),(0,n.jsx)(eF.Z.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"AllowAllModal.tsx"}),(0,n.jsxs)(eF.Z.Content,{className:"flex items-center justify-end space-x-2","data-sentry-element":"unknown","data-sentry-source-file":"AllowAllModal.tsx",children:[(0,n.jsx)(M.z,{type:"default",disabled:i,onClick:()=>t(),"data-sentry-element":"Button","data-sentry-source-file":"AllowAllModal.tsx",children:"Cancel"}),(0,n.jsx)(M.z,{loading:i,disabled:i,onClick:()=>r(),"data-sentry-element":"Button","data-sentry-source-file":"AllowAllModal.tsx",children:"Confirm"})]})]})},e$=e=>{let{visible:s,onClose:t}=e,{ref:a}=(0,f.UO)(),{mutate:o,isLoading:i}=eE({onSuccess:()=>t()}),r=async()=>{if(!a)return console.error("Project ref is required");await o({projectRef:a,dbAllowedCidrs:[],dbAllowedCidrsV6:[]})};return(0,n.jsxs)(eF.Z,{hideFooter:!0,size:"medium",visible:s,onCancel:t,header:"Restrict access from all IP addresses","data-sentry-element":"Modal","data-sentry-component":"DisallowAllModal","data-sentry-source-file":"DisallowAllModal.tsx",children:[(0,n.jsxs)(eF.Z.Content,{className:"space-y-4","data-sentry-element":"unknown","data-sentry-source-file":"DisallowAllModal.tsx",children:[(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"This will prevent any external IP addresses from accessing your project's database. Are you sure?"}),(0,n.jsx)(eO.Z,{defaultVisibility:!0,hideCollapse:!0,title:"Note: Restrictions only apply to direct connections to your database and Supavisor",description:"They do not currently apply to APIs offered over HTTPS, such as PostgREST, Storage, or Authentication.","data-sentry-element":"InformationBox","data-sentry-source-file":"DisallowAllModal.tsx"})]}),(0,n.jsx)(eF.Z.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"DisallowAllModal.tsx"}),(0,n.jsxs)(eF.Z.Content,{className:"flex items-center justify-end space-x-2","data-sentry-element":"unknown","data-sentry-source-file":"DisallowAllModal.tsx",children:[(0,n.jsx)(M.z,{type:"default",disabled:i,onClick:()=>t(),"data-sentry-element":"Button","data-sentry-source-file":"DisallowAllModal.tsx",children:"Cancel"}),(0,n.jsx)(M.z,{loading:i,disabled:i,onClick:()=>r(),"data-sentry-element":"Button","data-sentry-source-file":"DisallowAllModal.tsx",children:"Confirm"})]})]})},e0=e=>{var s,t,a,o;let{visible:i,selectedRestriction:r,onClose:l}=e,{ref:d}=(0,f.UO)(),{data:c}=eZ({projectRef:d}),u=null!==(a=null==c?void 0:null===(s=c.config)||void 0===s?void 0:s.dbAllowedCidrs)&&void 0!==a?a:[],m=null!==(o=null==c?void 0:null===(t=c.config)||void 0===t?void 0:t.dbAllowedCidrsV6)&&void 0!==o?o:[],x=u.concat(m),{mutate:p,isLoading:g}=eE({onSuccess:()=>l(),onError:e=>{h.Am.error("Failed to remove restriction: ".concat(e.message))}}),y=1===x.length&&x[0]===r,j=async()=>{if(!d)return console.error("Project ref is required");if(!r)return console.error("Missing selected restriction");let e=u.includes(r)?u.filter(e=>e!==r):u,s=m.includes(r)?m.filter(e=>e!==r):m;0===e.length&&0===s.length?p({projectRef:d,dbAllowedCidrs:["0.0.0.0/0"],dbAllowedCidrsV6:["::/0"]}):p({projectRef:d,dbAllowedCidrs:e,dbAllowedCidrsV6:s})};return(0,n.jsxs)(eF.Z,{hideFooter:!0,size:"medium",visible:i,onCancel:l,header:"Confirm to remove restriction","data-sentry-element":"Modal","data-sentry-component":"RemoveRestrictionModal","data-sentry-source-file":"RemoveRestrictionModal.tsx",children:[(0,n.jsxs)(eF.Z.Content,{className:"space-y-4","data-sentry-element":"unknown","data-sentry-source-file":"RemoveRestrictionModal.tsx",children:[(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:["The IPv4 address ",(0,n.jsx)("code",{className:"text-xs",children:r})," will be removed from your list of network restrictions",y?".":", and no longer have access to your project's database."]}),y&&(0,n.jsx)(L.J,{type:"warning",title:"Database access will no longer be restricted",description:"Removing all network restrictions will default to your database being accessible from all IP addresses."})]}),(0,n.jsxs)(eF.Z.Content,{className:"flex items-center justify-end space-x-2","data-sentry-element":"unknown","data-sentry-source-file":"RemoveRestrictionModal.tsx",children:[(0,n.jsx)(M.z,{type:"default",disabled:g,onClick:()=>l(),"data-sentry-element":"Button","data-sentry-source-file":"RemoveRestrictionModal.tsx",children:"Cancel"}),(0,n.jsx)(M.z,{loading:g,disabled:g,onClick:()=>j(),"data-sentry-element":"Button","data-sentry-source-file":"RemoveRestrictionModal.tsx",children:"Remove restriction"})]})]})};let e1=e=>{let{disabled:s,onClick:t}=e;return(0,n.jsxs)(T.u,{"data-sentry-element":"Tooltip","data-sentry-component":"AllowAllAccessButton","data-sentry-source-file":"NetworkRestrictions.tsx",children:[(0,n.jsx)(T.aJ,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"NetworkRestrictions.tsx",children:(0,n.jsx)(M.z,{type:"default",disabled:s,onClick:()=>t(!0),"data-sentry-element":"Button","data-sentry-source-file":"NetworkRestrictions.tsx",children:"Allow all access"})}),s&&(0,n.jsx)(T._v,{side:"bottom",children:"You need additional permissions to update network restrictions"})]})},e2=e=>{let{disabled:s,onClick:t}=e;return(0,n.jsx)(e_.u,{disabled:s,type:"default",onClick:()=>t(!0),tooltip:{content:{side:"bottom",text:s?"You need additional permissions to update network restrictions":void 0}},"data-sentry-element":"ButtonTooltip","data-sentry-component":"DisallowAllAccessButton","data-sentry-source-file":"NetworkRestrictions.tsx",children:"Restrict all access"})};var e4=()=>{var e,s,t,a,i;let{ref:r}=(0,f.UO)(),{project:l}=(0,y.d2)(),[d,c]=(0,x.useState)(),[u,m]=(0,x.useState)(!1),[p,h]=(0,x.useState)(!1),[g,b]=(0,x.useState)(),{data:w,isLoading:N}=eZ({projectRef:r}),S=(0,k.Xo)(o.KA.UPDATE,"projects",{resource:{project_id:null==l?void 0:l.id}}),C=(null==w?void 0:w.entitlement)==="allowed",P=null!==(t=null==w?void 0:null===(e=w.config)||void 0===e?void 0:e.dbAllowedCidrs)&&void 0!==t?t:[],z=null!==(a=null==w?void 0:null===(s=w.config)||void 0===s?void 0:s.dbAllowedCidrsV6)&&void 0!==a?a:[],_=P.concat(z),I=null!==(i=null==w?void 0:w.status)&&void 0!==i?i:"",D=0===_.length&&0===I.length,A=_.includes("0.0.0.0/0")&&_.includes("::/0"),Z=0===_.length;return C?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("section",{id:"network-restrictions",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsx)(v.p,{className:"mb-0",title:"Network Restrictions",description:"Allow specific IP ranges to have access to your database.","data-sentry-element":"FormHeader","data-sentry-source-file":"NetworkRestrictions.tsx"}),(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsx)(j.G,{href:"https://supabase.com/docs/guides/platform/network-restrictions","data-sentry-element":"DocsButton","data-sentry-source-file":"NetworkRestrictions.tsx"}),S?(0,n.jsxs)(eR.h_,{children:[(0,n.jsx)(eR.$F,{asChild:!0,children:(0,n.jsx)(M.z,{type:"primary",disabled:!S,iconRight:(0,n.jsx)(eC.Z,{size:14}),children:"Add restriction"})}),(0,n.jsxs)(eR.AW,{align:"end",side:"bottom",className:"w-48",children:[(0,n.jsx)(eR.Xi,{disabled:N,onClick:()=>c("IPv4"),children:(0,n.jsx)("p",{className:"block text-foreground",children:"Add IPv4 restriction"})},"IPv4"),(0,n.jsx)(eR.Xi,{disabled:N,onClick:()=>c("IPv6"),children:(0,n.jsx)("p",{className:"block text-foreground",children:"Add IPv6 restriction"})},"IPv6")]})]}):(0,n.jsx)(e_.u,{disabled:!0,type:"primary",tooltip:{content:{side:"bottom",text:"You need additional permissions to update network restrictions"}},children:"Add restriction"})]})]}),N?(0,n.jsx)(eo.Z,{children:(0,n.jsx)(eo.Z.Content,{children:(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(ei.Z,{}),(0,n.jsx)(ei.Z,{className:"w-[70%]"}),(0,n.jsx)(ei.Z,{className:"w-[50%]"})]})})}):"stored"===I?(0,n.jsx)(eo.Z,{children:(0,n.jsx)(eo.Z.Content,{children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(eP.Z,{size:20,strokeWidth:1.5,className:"text-foreground-light"}),(0,n.jsx)("p",{className:"text-sm",children:"Your network restrictions were not applied correctly"})]}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Please try to add your network restrictions again"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(e1,{disabled:!S,onClick:m}),(0,n.jsx)(e2,{disabled:!S,onClick:h})]})]})})}):(0,n.jsx)(eI.by,{children:D||A?(0,n.jsxs)("div",{className:"px-8 py-8 flex items-center justify-between",children:[(0,n.jsx)("div",{className:"flex items-start space-x-4",children:(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("p",{className:"text-foreground-light text-sm",children:"Your database can be accessed by all IP addresses"}),(0,n.jsx)("p",{className:"text-foreground-light text-sm",children:"You may start limiting access to your database by adding a network restriction."})]})}),(0,n.jsx)("div",{children:(0,n.jsx)(e2,{disabled:!S,onClick:h})})]}):Z?(0,n.jsxs)("div",{className:"px-8 py-8 flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,n.jsx)(ek.Z,{size:20,className:"text-foreground-light",strokeWidth:1.5}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)("p",{className:"text-foreground-light text-sm",children:["Your database ",(0,n.jsx)("span",{className:"text-amber-900 opacity-80",children:"cannot"})," be accessed externally"]}),(0,n.jsx)("p",{className:"text-foreground-light text-sm",children:"All external IP addresses have been disallowed from accessing your project's database."}),(0,n.jsx)("p",{className:"text-foreground-light text-sm",children:"Note: Restrictions only apply to your database, and not to Supabase services"})]})]}),(0,n.jsx)("div",{children:(0,n.jsx)(e1,{disabled:!S,onClick:m})})]}):(0,n.jsxs)("div",{className:"divide-y",children:[(0,n.jsxs)("div",{className:"px-8 py-3 flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-foreground-light text-sm",children:"Only the following IP addresses have access to your database"}),(0,n.jsx)("p",{className:"text-foreground-light text-sm",children:"You may remove all of them to allow all IP addresses to have access to your database"}),(0,n.jsx)("p",{className:"text-foreground-light text-sm",children:"Note: Restrictions only apply to your database, and not to Supabase services"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(e1,{disabled:!S,onClick:m}),(0,n.jsx)(e2,{disabled:!S,onClick:h})]})]}),_.map(e=>(0,n.jsxs)("div",{className:"px-8 py-4 flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-5",children:[(0,n.jsx)(ez.Z,{size:16,className:"text-foreground-light"}),(0,n.jsx)(F.C,{children:P.includes(e)?"IPv4":"IPv6"}),(0,n.jsx)("p",{className:"text-sm font-mono",children:e})]}),(0,n.jsx)(M.z,{type:"default",onClick:()=>b(e),children:"Remove"})]},e))]})})]}),(0,n.jsx)(eQ,{visible:u,onClose:()=>m(!1),"data-sentry-element":"AllowAllModal","data-sentry-source-file":"NetworkRestrictions.tsx"}),(0,n.jsx)(e$,{visible:p,onClose:()=>h(!1),"data-sentry-element":"DisallowAllModal","data-sentry-source-file":"NetworkRestrictions.tsx"}),(0,n.jsx)(eJ,{type:d,hasOverachingRestriction:A||Z,onClose:()=>c(void 0),"data-sentry-element":"AddRestrictionModal","data-sentry-source-file":"NetworkRestrictions.tsx"}),(0,n.jsx)(e0,{visible:void 0!==g,selectedRestriction:g,onClose:()=>b(void 0),"data-sentry-element":"RemoveRestrictionModal","data-sentry-source-file":"NetworkRestrictions.tsx"})]}):null};let e3=e=>["projects",e,"banned-ips"];async function e5(e){let{projectRef:s,ips:t}=e,{data:n,error:a}=await (0,eu.IV)("/v1/projects/{ref}/network-bans",{params:{path:{ref:s}},body:{ipv4_addresses:t}});return a&&(0,eu.S3)(a),n}let e8=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,ed.NL)();return(0,ec.D)(e=>e5(e),{async onSuccess(s,t,a){let{projectRef:o}=t;await n.invalidateQueries(e3(o)),await (null==e?void 0:e(s,t,a))},async onError(e,t,n){void 0===s?h.Am.error("Failed to unban ips: ".concat(e.message)):s(e,t,n)},...t})};async function e6(e,s){let{projectRef:t}=e;if(!t)throw Error("projectRef is required");let{data:n,error:a}=await (0,eu.v_)("/v1/projects/{ref}/network-bans/retrieve",{params:{path:{ref:t}},signal:s});return a&&(0,eu.S3)(a),n}let e9=function(e){let{projectRef:s}=e,{enabled:t=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,eM.a)(e3(s),e=>{let{signal:t}=e;return e6({projectRef:s},t)},{enabled:t&&void 0!==s,...n})};var e7=t(32002),se=()=>{let{ref:e}=(0,f.UO)(),{project:s}=(0,y.d2)(),[t,a]=(0,x.useState)(null),{data:i}=e9({projectRef:e}),[r,l]=(0,x.useState)(!1),[d,c]=(0,x.useState)(null),u=(0,k.Xo)(o.KA.UPDATE,"projects",{resource:{project_id:null==s?void 0:s.id}}),{mutate:m,isLoading:p}=e8({onSuccess:()=>{h.Am.success("IP address successfully unbanned"),a(null),l(!1)},onError:e=>{h.Am.error("Failed to unban IP: ".concat(null==e?void 0:e.message))}}),g=e=>{a(e),c(e),l(!0)},[b,w]=(0,x.useState)(null);return(0,x.useEffect)(()=>{fetch("".concat(I.GW,"/api/get-ip-address")).then(e=>e.json()).then(e=>w(e.ipAddress))},[]),(0,n.jsxs)("div",{id:"banned-ips","data-sentry-component":"BannedIPs","data-sentry-source-file":"BannedIPs.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsx)(v.p,{className:"mb-0",title:"Network Bans",description:"List of IP addresses that are temporarily blocked if their traffic pattern looks abusive","data-sentry-element":"FormHeader","data-sentry-source-file":"BannedIPs.tsx"}),(0,n.jsx)(j.G,{href:"https://supabase.com/docs/reference/cli/supabase-network-bans","data-sentry-element":"DocsButton","data-sentry-source-file":"BannedIPs.tsx"})]}),(0,n.jsx)(eI.by,{"data-sentry-element":"FormPanel","data-sentry-source-file":"BannedIPs.tsx",children:i&&i.banned_ipv4_addresses.length>0?i.banned_ipv4_addresses.map(e=>(0,n.jsxs)("div",{className:"px-8 py-4 flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-5",children:[(0,n.jsx)(ez.Z,{size:16,className:"text-foreground-lighter"}),(0,n.jsx)("p",{className:"text-sm font-mono",children:e}),e===b&&(0,n.jsx)(F.C,{children:"Your IP address"})]}),(0,n.jsx)("div",{children:(0,n.jsx)(e_.u,{type:"default",disabled:!u,onClick:()=>g(e),tooltip:{content:{side:"bottom",text:u?void 0:"You need additional permissions to unban networks"}},children:"Unban IP"})})]},e)):(0,n.jsx)("p",{className:"text-foreground-light text-sm px-8 py-4",children:"There are no banned IP addresses for your project."})}),(0,n.jsx)(e7.Z,{variant:"destructive",size:"medium",loading:p,visible:r,title:"Confirm Unban IP",confirmLabel:"Confirm Unban",confirmLabelLoading:"Unbanning...",onCancel:()=>l(!1),onConfirm:()=>{null!=d&&e&&m({projectRef:e,ips:[d]})},alert:{title:"This action cannot be undone",description:"Are you sure you want to unban this IP address ".concat(t,"?")},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"BannedIPs.tsx"})]})},ss=t(50416),st=t(14306),sn=t(60025),sa=t(39057);let so=()=>(0,n.jsxs)("div",{className:"w-full flex flex-col xl:flex-row border py-10 pl-10 rounded-md","data-sentry-component":"ConnectionStringMoved","data-sentry-source-file":"ConnectionStringMoved.tsx",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-0 z-[2]",children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:"Connection string has moved"}),(0,n.jsx)("p",{className:"text-sm text-foreground-lighter",children:"You can find Project connect details by clicking 'Connect' in the top bar"})]}),(0,n.jsxs)("div",{className:"relative grow flex flex-col -space-y-px",children:[(0,n.jsx)("div",{className:"w-full h-3",children:(0,n.jsx)("div",{className:"bg-gradient-to-t from-background-surface-300 via-[25%] to-background-200 to-[100%] h-full w-full"})}),(0,n.jsxs)("div",{className:"flex justify-end relative",children:[(0,n.jsxs)("div",{className:"bg-dash-sidebar border-b border-t border-t-border-muted py-2 px-10 flex gap-3 relative overflow-hidden",children:[(0,n.jsx)(M.z,{type:"text",size:"tiny",className:"rounded-full pointer-events-none opacity-50",iconRight:(0,n.jsx)(ss.Z,{size:12,strokeWidth:1.5}),"data-sentry-element":"Button","data-sentry-source-file":"ConnectionStringMoved.tsx",children:"Project name"}),(0,n.jsx)(M.z,{type:"default",size:"tiny",className:"rounded-full pointer-events-none ring-1 ring-foreground-muted/20",icon:(0,n.jsx)(st.Z,{size:12,className:"rotate-90"}),"data-sentry-element":"Button","data-sentry-source-file":"ConnectionStringMoved.tsx",children:"Connect"}),(0,n.jsx)(M.z,{type:"text",size:"tiny",className:"rounded-full pointer-events-none -mr-20 opacity-50",icon:(0,n.jsx)(sn.Z,{size:12}),"data-sentry-element":"Button","data-sentry-source-file":"ConnectionStringMoved.tsx",children:"Enable Branching"})]}),(0,n.jsx)(sa.Z,{className:" absolute top-7 right-[110px] text-foreground-light fill-background",strokeWidth:1,"data-sentry-element":"Pointer","data-sentry-source-file":"ConnectionStringMoved.tsx"})]}),(0,n.jsx)("div",{className:"absolute -inset-2 bg-gradient-to-l from-transparent via-background-200 via-[95%] to-background-200 to-[100%] z-[1]"})]})]});var si=t(71770),sr=t(4839),sl=t(86007),sd=t(5731);async function sc(e){let{projectRef:s}=e,{data:t,error:n}=await (0,eu.v_)("/v1/projects/{ref}/readonly/temporary-disable",{params:{path:{ref:s}}});return n&&(0,eu.S3)(n),t}let su=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,ed.NL)();return(0,ec.D)(e=>sc(e),{async onSuccess(s,t,a){setTimeout(()=>n.invalidateQueries(sd.Z.resourceWarnings()),2e3),await (null==e?void 0:e(s,t,a))},async onError(e,t,n){void 0===s?h.Am.error("Failed to disable read only mode: ".concat(e.message)):s(e,t,n)},...t})};var sm=e=>{let{visible:s,onClose:t}=e,{ref:a}=(0,f.UO)(),{mutate:o,isLoading:i}=su({onSuccess:()=>{h.Am.success("Successfully disabled read-only mode for 15 minutes"),t()}});return(0,n.jsx)(eF.Z,{alignFooter:"right",visible:s,onCancel:t,loading:i,confirmText:"Disable read-only mode",header:"Confirm to temporarily disable read-only mode",onConfirm:()=>{if(!a)return console.error("Project ref is required");o({projectRef:a})},"data-sentry-element":"Modal","data-sentry-component":"ConfirmDisableReadOnlyModeModal","data-sentry-source-file":"ConfirmDisableReadOnlyModal.tsx",children:(0,n.jsxs)(eF.Z.Content,{className:"space-y-2","data-sentry-element":"unknown","data-sentry-source-file":"ConfirmDisableReadOnlyModal.tsx",children:[(0,n.jsxs)("p",{className:"text-sm",children:["This will temporarily allow writes to your database for the"," ",(0,n.jsx)("span",{className:"text-amber-900",children:"next 15 minutes"}),", during which you can reduce your database size. After deleting data, you should run a vacuum to reclaim as much space as possible."]}),(0,n.jsx)("p",{className:"text-sm",children:"If your database size has not been sufficiently reduced after 15 minutes, read-only mode will be toggled back on. Otherwise, it will stay disabled."})]})})};let sx=()=>{var e,s,t;let{ref:a}=(0,f.UO)(),o=(0,z.l)(),[i,r]=(0,x.useState)(!1),{data:l}=(0,sl.q)(),{data:d}=(0,C.Gl)({orgSlug:null==o?void 0:o.slug}),c=null!==(t=null===(s=null!=l?l:[])||void 0===s?void 0:null===(e=s.find(e=>e.project===a))||void 0===e?void 0:e.is_readonly_mode_enabled)&&void 0!==t&&t;return(0,n.jsxs)(n.Fragment,{children:[c&&(0,n.jsxs)(D.bZ,{variant:"destructive",children:[(0,n.jsx)(si.Z,{}),(0,n.jsx)(D.Cd,{children:"Project is in read-only mode and database is no longer accepting write requests"}),(0,n.jsxs)(D.X,{children:["You have reached 95% of your project's disk space, and read-only mode has been enabled to preserve your database's stability and prevent your project from exceeding its current billing plan. To resolve this, you may:",(0,n.jsxs)("ul",{className:"list-disc pl-6 mt-1",children:[(0,n.jsx)("li",{children:"Temporarily disable read-only mode to free up space and reduce your database size"}),(null==d?void 0:d.plan.id)==="free"?(0,n.jsxs)("li",{children:[(0,n.jsx)(m(),{href:"/org/".concat(null==o?void 0:o.slug,"/billing?panel=subscriptionPlan"),children:(0,n.jsx)("a",{className:"text underline",children:"Upgrade to the Pro Plan"})})," ","to increase your database size limit to 8GB."]}):(null==d?void 0:d.plan.id)==="pro"&&(null==d?void 0:d.usage_billing_enabled)?(0,n.jsxs)("li",{children:[(0,n.jsx)(m(),{href:"/org/".concat(null==o?void 0:o.slug,"/billing?panel=subscriptionPlan"),children:(0,n.jsx)("a",{className:"text-foreground underline",children:"Disable your Spend Cap"})})," ","to allow your project to auto-scale and expand beyond the 8GB database size limit"]}):null]})]}),(0,n.jsxs)("div",{className:"mt-4 flex items-center space-x-2",children:[(0,n.jsx)(M.z,{type:"default",onClick:()=>r(!0),children:"Disable read-only mode"}),(0,n.jsx)(M.z,{asChild:!0,type:"default",icon:(0,n.jsx)(sr.Z,{}),children:(0,n.jsx)("a",{href:"https://supabase.com/docs/guides/platform/database-size#disabling-read-only-mode",target:"_blank",rel:"noreferrer",children:"Learn more"})})]})]}),(0,n.jsx)(sm,{visible:i,onClose:()=>r(!1),"data-sentry-element":"ConfirmDisableReadOnlyModeModal","data-sentry-source-file":"DatabaseReadOnlyAlert.tsx"})]})};var sp=t(77837),sh=t.n(sp),sf=t(92303),sg=t(71207);async function sy(e){let{ref:s,password:t}=e;if(!s)return console.error("Project ref is required");let{data:n,error:a}=await (0,eu.r$)("/platform/projects/{ref}/db-password",{params:{path:{ref:s}},body:{password:t}});return a&&(0,eu.S3)(a),n}let sj=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,ed.NL)();return(0,ec.D)(e=>sy(e),{async onSuccess(s,t,a){await n.invalidateQueries(sg.i.detail(t.ref)),await (null==e?void 0:e(s,t,a))},async onError(e,t,n){void 0===s?h.Am.error("Failed to reset database password: ".concat(e.message)):s(e,t,n)},...t})};var sv=t(81541),sb=t(46615),sw=e=>{let{disabled:s=!1}=e,{ref:t}=(0,f.UO)(),a=(0,y.gY)(),{project:i}=(0,y.d2)(),r=(0,k.Xo)(o.KA.UPDATE,"projects",{resource:{project_id:null==i?void 0:i.id}}),[l,d]=(0,x.useState)(!1),[c,u]=(0,x.useState)(""),[m,p]=(0,x.useState)(""),[g,j]=(0,x.useState)(""),[v,b]=(0,x.useState)(0),{mutate:w,isLoading:N}=sj({onSuccess:async()=>{h.Am.success("Successfully updated database password"),d(!1)}});async function S(e){let{message:s,warning:t,strength:n}=await (0,sv.Z)(e);b(n),j(t),p(s)}(0,x.useEffect)(()=>{l&&(u(""),p(""),j(""),b(0))},[l]);let C=(0,x.useRef)(sh()(e=>S(e),300)).current,P=async()=>{if(!t)return console.error("Project ref is required");v>=I.lS&&w({ref:t,password:c})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eo.Z,{className:"!m-0","data-sentry-element":"Panel","data-sentry-source-file":"ResetDbPassword.tsx",children:(0,n.jsx)(eo.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"ResetDbPassword.tsx",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 items-center lg:grid-cols-3 scroll-mt-6",id:"database-password",children:[(0,n.jsxs)("div",{className:"col-span-2 space-y-1",children:[(0,n.jsx)("p",{className:"block",children:"Database password"}),(0,n.jsx)("p",{className:"text-sm opacity-50",children:"You can use this password to connect directly to your Postgres database."})]}),(0,n.jsx)("div",{className:"flex items-end justify-end",children:(0,n.jsx)(e_.u,{type:"default",disabled:!r||!a||s,onClick:()=>d(!0),tooltip:{content:{side:"bottom",text:r?a?void 0:"Unable to reset database password as project is not active":"You need additional permissions to reset the database password"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"ResetDbPassword.tsx",children:"Reset database password"})})]})})}),(0,n.jsxs)(eF.Z,{hideFooter:!0,header:(0,n.jsx)("h5",{className:"text-sm text-foreground",children:"Reset database password"}),confirmText:"Reset password",size:"medium",visible:l,loading:N,onCancel:()=>d(!1),"data-sentry-element":"Modal","data-sentry-source-file":"ResetDbPassword.tsx",children:[(0,n.jsx)(eF.Z.Content,{className:"w-full space-y-8","data-sentry-element":"unknown","data-sentry-source-file":"ResetDbPassword.tsx",children:(0,n.jsx)(eB.Z,{type:"password",value:c,copy:c.length>0,onChange:e=>{let s=e.target.value;u(s),""==s?(b(-1),p("")):C(s)},error:g,descriptionText:(0,n.jsx)(sf.Z,{passwordStrengthScore:v,passwordStrengthMessage:m,password:c,generateStrongPassword:function(){let e=(0,sb.Q)();u(e),C(e)}}),"data-sentry-element":"Input","data-sentry-source-file":"ResetDbPassword.tsx"})}),(0,n.jsx)(eF.Z.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"ResetDbPassword.tsx"}),(0,n.jsxs)(eF.Z.Content,{className:"flex items-center justify-end space-x-2","data-sentry-element":"unknown","data-sentry-source-file":"ResetDbPassword.tsx",children:[(0,n.jsx)(M.z,{type:"default",disabled:N,onClick:()=>d(!1),"data-sentry-element":"Button","data-sentry-source-file":"ResetDbPassword.tsx",children:"Cancel"}),(0,n.jsx)(M.z,{type:"primary",loading:N,disabled:N,onClick:()=>P(),"data-sentry-element":"Button","data-sentry-source-file":"ResetDbPassword.tsx",children:"Reset password"})]})]})]})},sN=t(28977),sS=t.n(sN),sC=t(38210),sP=t(96956),sk=t(77769),sz=t(53114),s_=t(45536),sI=t(7756),sM=e=>{var s,t,a,i,r;let{disabled:d=!1}=e,{ref:c}=(0,f.UO)(),{project:u}=(0,y.d2)(),{lastDatabaseResizeAt:x}=null!=u?u:{},p=(0,z.l)();null===x||sS()().diff(x,"minutes");let[{show_increase_disk_size_modal:g},j]=(0,sz.x)(),b="true"===g,w=e=>{j({show_increase_disk_size_modal:("function"==typeof e?e(b):e)?"true":void 0})},N=(0,k.Xo)(o.KA.UPDATE,"projects",{resource:{project_id:null==u?void 0:u.id}}),{data:S}=(0,C.Gl)({orgSlug:null==p?void 0:p.slug}),{isLoading:P}=(0,sP.O)({onSuccess:(e,s)=>{h.Am.success("Successfully updated disk size to ".concat(s.volumeSize," GB")),w(!1)}}),_=null!==(r=null==u?void 0:u.volumeSizeGb)&&void 0!==r?r:0,{data:I}=(0,sk.YM)({projectRef:null==u?void 0:u.ref,connectionString:null==u?void 0:u.connectionString});return(0,n.jsxs)("div",{id:"diskManagement","data-sentry-component":"DiskSizeConfiguration","data-sentry-source-file":"DiskSizeConfiguration.tsx",children:[(0,n.jsx)(v.p,{title:"Disk Management","data-sentry-element":"FormHeader","data-sentry-source-file":"DiskSizeConfiguration.tsx"}),(null==S?void 0:S.usage_billing_enabled)===!0?(0,n.jsx)("div",{className:"flex flex-col gap-3",children:(0,n.jsx)(eo.Z,{className:"!m-0",children:(0,n.jsx)(eo.Z.Content,{children:(0,n.jsx)("div",{children:(0,n.jsxs)("div",{children:[_&&(0,n.jsx)("span",{className:"text-foreground-light flex gap-2 items-baseline",children:(0,n.jsx)("h4",{className:"text-foreground",children:"Current Disk Storage"})}),(0,n.jsxs)("div",{className:"grid grid-cols-2 items-center",children:[(0,n.jsx)("p",{className:"text-sm text-lighter max-w-lg",children:"Supabase employs auto-scaling storage and allows for manual disk size adjustments when necessary"}),(0,n.jsx)("div",{className:"flex items-end justify-end",children:(0,n.jsx)(e_.u,{type:"default",disabled:!N||d,onClick:()=>w(!0),tooltip:{content:{side:"bottom",text:N?void 0:"You need additional permissions to increase the disk size"}},children:"Increase disk size"})})]}),(0,n.jsxs)("div",{className:"grid grid-cols-12 gap-2 mt-12 items-start",children:[(0,n.jsxs)("div",{className:"col-span-4 grid grid-cols-2 gap-x-12 gap-y-4 items-start",children:[(0,n.jsxs)("div",{className:"grid gap-2 col-span-1",children:[(0,n.jsx)("h5",{className:"text-sm",children:"Space used"}),(0,n.jsx)("span",{className:"text-lg",children:(0,s_.td)(null!=I?I:0,2,"GB")})]}),(0,n.jsxs)("div",{className:"grid gap-2 col-span-1",children:[(0,n.jsx)("h5",{className:"text-sm",children:"Total size"}),(0,n.jsxs)("span",{className:"text-lg",children:[_," GB"]})]}),(0,n.jsx)("div",{className:"col-span-2 mt-4",children:(0,n.jsx)(M.z,{asChild:!0,type:"default",iconRight:(0,n.jsx)(sr.Z,{size:14}),children:(0,n.jsx)(m(),{href:"/project/".concat(c,"/reports/database#database-size-report"),children:"View detailed summary"})})})]}),(0,n.jsx)("div",{className:"col-span-8",children:(0,n.jsxs)(D.bZ,{children:[(0,n.jsx)(l.Z,{size:16}),(0,n.jsx)(D.Cd,{children:"Importing a lot of data?"}),(0,n.jsx)(D.X,{children:(0,n.jsx)(G.U,{className:"max-w-full",content:"\nWe auto-scale your disk as you need more storage, but can only do this once every 6 hours.\nIf you upload more than 1.5x the current size of your storage, your database will go\ninto read-only mode. If you know how big your database is going to be, you can\nmanually increase the size here.\n\nRead more about [disk management](https://supabase.com/docs/guides/platform/database-size#disk-management) and how to [free up storage space](https://supabase.com/docs/guides/platform/database-size#vacuum-operations).\n"})})]})})]})]})})})})}):(0,n.jsxs)(D.bZ,{children:[(0,n.jsx)(sI.sz,{}),(0,n.jsx)(D.Cd,{children:(null==S?void 0:null===(s=S.plan)||void 0===s?void 0:s.id)==="free"?"Disk size configuration is not available for projects on the Free Plan":"Disk size configuration is only available when the spend cap has been disabled"}),(0,n.jsxs)(D.X,{children:[(null==S?void 0:null===(t=S.plan)||void 0===t?void 0:t.id)==="free"?(0,n.jsx)("p",{children:"If you are intending to use more than 500MB of disk space, then you will need to upgrade to at least the Pro Plan."}):(0,n.jsx)("p",{children:"If you are intending to use more than 8GB of disk space, then you will need to disable your spend cap."}),(0,n.jsx)(M.z,{asChild:!0,type:"default",className:"mt-3",children:(0,n.jsx)(m(),{href:"/org/".concat(null==p?void 0:p.slug,"/billing?panel=").concat((null==S?void 0:null===(a=S.plan)||void 0===a?void 0:a.id)==="free"?"subscriptionPlan":"costControl"),target:"_blank",children:(null==S?void 0:null===(i=S.plan)||void 0===i?void 0:i.id)==="free"?"Upgrade subscription":"Disable spend cap"})})]})]}),(0,n.jsx)(sC.Z,{visible:b,loading:P,hideModal:w,"data-sentry-element":"DiskSizeConfigurationModal","data-sentry-source-file":"DiskSizeConfiguration.tsx"})]})},sD=t(619),sA=t(36210);let sZ=()=>{let{ref:e}=(0,f.UO)(),s=ey(),t=(0,sD.TF)(),{data:a}=(0,el.Y)({projectRef:e}),o=null==a?void 0:a.find(e=>e.identifier===t.selectedDatabaseId),i=()=>{let e=document.getElementById("connection-pooler");e&&e.scrollIntoView({behavior:"smooth",block:"center"})};return(0,n.jsx)(sA.Vq,{open:s.showPoolingModeHelper,onOpenChange:s.setShowPoolingModeHelper,"data-sentry-element":"Dialog","data-sentry-component":"PoolingModesModal","data-sentry-source-file":"PoolingModesModal.tsx",children:(0,n.jsxs)(sA.cZ,{hideClose:!0,className:"sm:max-w-4xl","data-sentry-element":"DialogContent","data-sentry-source-file":"PoolingModesModal.tsx",children:[(0,n.jsxs)(sA.fK,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"PoolingModesModal.tsx",children:[(0,n.jsx)(sA.$N,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"PoolingModesModal.tsx",children:(0,n.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,n.jsx)("p",{className:"max-w-2xl",children:"Which pooling mode should I use?"}),(0,n.jsx)(j.G,{href:"https://supabase.com/docs/guides/database/connecting-to-postgres#how-connection-pooling-works","data-sentry-element":"DocsButton","data-sentry-source-file":"PoolingModesModal.tsx"})]})}),(0,n.jsx)(sA.Be,{className:"max-w-2xl","data-sentry-element":"DialogDescription","data-sentry-source-file":"PoolingModesModal.tsx",children:"A connection pooler is a system (external to Postgres) which manages Postgres connections by allocating connections whenever clients make requests."})]}),(0,n.jsx)(sA.P3,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"PoolingModesModal.tsx"}),(0,n.jsx)(sA.VO,{"data-sentry-element":"DialogSection","data-sentry-source-file":"PoolingModesModal.tsx",children:(0,n.jsx)(G.U,{className:"max-w-full [&>h3]:text-sm",content:"\nEach pooling mode handles connections differently.\n\n### Transaction mode\nThis mode is recommended if you are connecting from *serverless environments*. A connection is assigned to the client for the duration of a transaction. Two consecutive transactions from the same client could be executed over two different connections. Some session-based Postgres features such as prepared statements are *not available* with this option.\n\n### Session mode\nThis mode is similar to connecting to your database directly. There is full support for prepared statements in this mode. When a new client connects, a connection is assigned to the client until it disconnects. You *might run into pooler connection limits* since the connection is held till the client disconnects.\n\n### Using session and transaction modes at the same time\n ".concat((null==o?void 0:o.pool_mode)==="transaction"?"You can use the session mode connection string (port 5432) and transaction mode connection string (port 6543) in your application.":"To get the best of both worlds, as a starting point, we recommend using session mode just when you need support for prepared statements and transaction mode in other cases.","\n"),"data-sentry-element":"Markdown","data-sentry-source-file":"PoolingModesModal.tsx"})}),(null==o?void 0:o.pool_mode)==="session"&&(0,n.jsx)("div",{className:"px-6",children:(0,n.jsxs)(D.bZ,{variant:"warning",children:[(0,n.jsx)(si.Z,{strokeWidth:2}),(0,n.jsx)(D.Cd,{children:"Pooling mode is currently configured to use session mode"}),(0,n.jsxs)(D.X,{children:["To use transaction mode concurrently with session mode, change the pooling mode to transaction first in the"," ",(0,n.jsx)("span",{tabIndex:0,className:"text-foreground cursor-pointer underline underline-offset-2",onClick:()=>{s.setShowPoolingModeHelper(!1),i()},children:"connection pooling settings"}),". After this, you can use transaction mode on port 6543 and session mode on port 5432."]})]})}),(0,n.jsx)(sA.cN,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"PoolingModesModal.tsx",children:(0,n.jsx)(sA.GG,{onClick:()=>s.setShowPoolingModeHelper(!1),"data-sentry-element":"DialogClose","data-sentry-source-file":"PoolingModesModal.tsx",children:(0,n.jsx)(M.z,{type:"default","data-sentry-element":"Button","data-sentry-source-file":"PoolingModesModal.tsx",children:"Close"})})})]})})};var sR=t(52675),sF=t(29790),sT=t(46993),sB=t(31485);let sO=e=>["projects",e,"ssl-enforcement"];async function sL(e,s){let{projectRef:t}=e;if(!t)throw Error("projectRef is required");let{data:n,error:a}=await (0,eu.U2)("/v1/projects/{ref}/ssl-enforcement",{params:{path:{ref:t}},signal:s});if(a){var o;if((null==a?void 0:a.code)===400&&(null==a?void 0:null===(o=a.message)||void 0===o?void 0:o.includes("not allowed to configure SSL enforcements")))return{appliedSuccessfully:!1,currentConfig:{database:!1},isNotAllowed:!0};(0,eu.S3)(a)}return n}let sE=function(e){let{projectRef:s}=e,{enabled:t=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,eM.a)(sO(s),e=>{let{signal:t}=e;return sL({projectRef:s},t)},{enabled:t&&void 0!==s,...n})};async function sV(e){let{projectRef:s,requestedConfig:t}=e;if(!s)throw Error("projectRef is required");let{data:n,error:a}=await (0,eu.gz)("/v1/projects/{ref}/ssl-enforcement",{params:{path:{ref:s}},body:{requestedConfig:t}});return a&&(0,eu.S3)(a),n}let sG=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,ed.NL)();return(0,ec.D)(e=>sV(e),{async onSuccess(s,t,a){let{projectRef:o}=t;await n.invalidateQueries(sO(o)),await (null==e?void 0:e(s,t,a))},async onError(e,t,n){void 0===s?h.Am.error("Failed to update SSL enforcement: ".concat(e.message)):s(e,t,n)},...t})};var sY=t(10611),sU=t(62210),sq=()=>{let{ref:e}=(0,f.UO)(),[s,t]=(0,x.useState)(!1),{data:a}=(0,sB.zR)({projectRef:e}),{data:i,isLoading:r,isSuccess:l}=sE({projectRef:e}),{mutate:d,isLoading:c}=sG({onSuccess:()=>{h.Am.success("Successfully updated SSL configuration")},onError:e=>{t(g),h.Am.error("Failed to update SSL enforcement: ".concat(e.message))}}),{project:u}=(0,y.d2)(),p=(0,k.Xo)(o.KA.UPDATE,"projects",{resource:{project_id:null==u?void 0:u.id}}),g=!!l&&i.appliedSuccessfully&&i.currentConfig.database,b=!(void 0!==i&&"isNotAllowed"in i&&i.isNotAllowed),w="prod",N=(null==a?void 0:a.inserted_at)!==void 0&&new Date(a.inserted_at)>=new Date("2021-04-30");(0,x.useEffect)(()=>{!r&&i&&t(g)},[r]);let S=async()=>{if(!e)return console.error("Project ref is required");t(!s),d({projectRef:e,requestedConfig:{database:!s}})};return(0,n.jsxs)("div",{id:"ssl-configuration","data-sentry-component":"SSLConfiguration","data-sentry-source-file":"SSLConfiguration.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsx)(v.p,{className:"mb-0",title:"SSL Configuration",description:"","data-sentry-element":"FormHeader","data-sentry-source-file":"SSLConfiguration.tsx"}),(0,n.jsx)(j.G,{href:"https://supabase.com/docs/guides/platform/ssl-enforcement","data-sentry-element":"DocsButton","data-sentry-source-file":"SSLConfiguration.tsx"})]}),(0,n.jsxs)(eI.by,{"data-sentry-element":"FormPanel","data-sentry-source-file":"SSLConfiguration.tsx",children:[(0,n.jsx)(sT.hj,{header:(0,n.jsx)(sT.S0,{className:"lg:col-span-7",description:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Reject non-SSL connections to your database"}),l&&!(null==i?void 0:i.appliedSuccessfully)&&(0,n.jsxs)(sY.b,{withIcon:!0,variant:"warning",title:"SSL enforcement was not updated successfully",children:["Please try updating again, or contact"," ",(0,n.jsx)(m(),{href:"/support/new",target:"_blank",rel:"noreferrer",className:"underline",children:"support"})," ","if this error persists"]})]}),children:"Enforce SSL on incoming connections"}),"data-sentry-element":"FormSection","data-sentry-source-file":"SSLConfiguration.tsx",children:(0,n.jsx)(sT.B4,{loading:!1,className:"lg:!col-span-5","data-sentry-element":"FormSectionContent","data-sentry-source-file":"SSLConfiguration.tsx",children:(0,n.jsxs)("div",{className:"flex items-center justify-end mt-2.5 space-x-2",children:[(r||c)&&(0,n.jsx)(sR.Z,{className:"animate-spin",strokeWidth:1.5,size:16}),l&&(0,n.jsxs)(T.u,{children:[(0,n.jsx)(T.aJ,{asChild:!0,children:(0,n.jsx)("div",{children:(0,n.jsx)(sU.r,{size:"large",checked:s,disabled:r||c||!p||!b,onCheckedChange:S})})}),(!p||!b)&&(0,n.jsx)(T._v,{side:"bottom",className:"w-64 text-center",children:p?b?"":"Your project does not have access to SSL enforcement":"You need additional permissions to update SSL enforcement for your project"})]})]})})}),(0,n.jsxs)("div",{className:"grid grid-cols-1 items-center lg:grid-cols-2 p-8",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("p",{className:"block text-sm",children:"SSL Certificate"}),(0,n.jsx)("div",{style:{maxWidth:"420px"},children:(0,n.jsx)("p",{className:"text-sm opacity-50",children:"Use this certificate when connecting to your database to prevent snooping and man-in-the-middle attacks."})})]}),(0,n.jsx)("div",{className:"flex items-end justify-end",children:N?(0,n.jsx)(M.z,{type:"default",icon:(0,n.jsx)(sF.Z,{}),children:(0,n.jsx)("a",{href:"https://supabase-downloads.s3-ap-southeast-1.amazonaws.com/".concat(w,"/ssl/").concat(w,"-ca-2021.crt"),children:"Download certificate"})}):(0,n.jsx)(e_.u,{disabled:!0,type:"default",icon:(0,n.jsx)(sF.Z,{}),tooltip:{content:{side:"bottom",text:"Projects before 15:08 (GMT+08), 29th April 2021 do not have SSL certificates installed"}},children:"Download certificate"})})]})]})]})},sH=t(19697),sW=t(78066),sX=t(62432);let sJ=()=>{let e=(0,sX.Vm)(),s=(null==e?void 0:e.cloud_provider)==="AWS";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(sW._S,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"database.tsx",children:(0,n.jsx)(sW.tU,{"data-sentry-element":"ScaffoldHeader","data-sentry-source-file":"database.tsx",children:(0,n.jsx)(sW.q7,{"data-sentry-element":"ScaffoldTitle","data-sentry-source-file":"database.tsx",children:"Database Settings"})})}),(0,n.jsx)(sW._S,{bottomPadding:!0,"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"database.tsx",children:(0,n.jsxs)("div",{className:"space-y-10",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-y-10",children:[(0,n.jsx)(sx,{"data-sentry-element":"DatabaseReadOnlyAlert","data-sentry-source-file":"database.tsx"}),(0,n.jsx)(so,{"data-sentry-element":"ConnectionStringMoved","data-sentry-source-file":"database.tsx"}),(0,n.jsx)(sw,{"data-sentry-element":"ResetDbPassword","data-sentry-source-file":"database.tsx"}),(0,n.jsx)(eS,{"data-sentry-element":"ConnectionPooling","data-sentry-source-file":"database.tsx"})]}),(0,n.jsx)(sq,{"data-sentry-element":"SSLConfiguration","data-sentry-source-file":"database.tsx"}),s?(0,n.jsx)($,{}):(0,n.jsx)(sM,{}),(0,n.jsx)(e4,{"data-sentry-element":"NetworkRestrictions","data-sentry-source-file":"database.tsx"}),(0,n.jsx)(se,{"data-sentry-element":"BannedIPs","data-sentry-source-file":"database.tsx"})]})}),(0,n.jsx)(sZ,{"data-sentry-element":"PoolingModesModal","data-sentry-source-file":"database.tsx"})]})};sJ.getLayout=e=>(0,n.jsx)(sH.Z,{title:"Database",children:e});var sK=sJ},10611:function(e,s,t){"use strict";t.d(s,{b:function(){return m}});var n=t(97458),a=t(52983),o=t(25843),i=t(41111),r=t(97146),l=t(71770),d=t(90953),c=t(98686);let u={danger:(0,n.jsx)(i.Z,{strokeWidth:1.5,size:18}),success:(0,n.jsx)(r.Z,{strokeWidth:1.5,size:18}),warning:(0,n.jsx)(l.Z,{strokeWidth:1.5,size:18}),info:(0,n.jsx)(d.Z,{strokeWidth:1.5,size:18}),neutral:(0,n.jsx)(n.Fragment,{})};function m(e){let{variant:s="neutral",className:t,title:i,withIcon:r,closable:l,children:d,icon:m,actions:x}=e,p=(0,o.Z)("alert"),[h,f]=(0,a.useState)(!0),g=[p.base];g.push(p.variant[s].base),t&&g.push(t);let y=[p.description,p.variant[s].description],j=[p.close];return(0,n.jsx)(n.Fragment,{children:h&&(0,n.jsxs)("div",{className:g.join(" "),children:[r?(0,n.jsx)("div",{className:p.variant[s].icon,children:r&&u[s]}):null,m&&m,(0,n.jsxs)("div",{className:"flex flex-1 items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:[p.variant[s].header,p.header].join(" "),children:i}),(0,n.jsx)("div",{className:y.join(" "),children:d})]}),x]}),l&&(0,n.jsx)("button",{"aria-label":"Close alert",onClick:()=>f(!1),className:j.join(" "),children:(0,n.jsx)(c.Z,{strokeWidth:2,size:16})})]})})}},19540:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});var n=t(97458),a=t(52983),o=t(68985),i=t(11499);function r(e,s){if(!s.error)return delete e[s.key],e;if(s)return{...e,[s.key]:s.error};throw Error()}function l(e){let{validate:s,...t}=e,[l,d]=(0,a.useReducer)(r,null),c=(0,o.TA)({validateOnBlur:!0,...t,validationSchema:t.validationSchema,initialValues:t.initialValues,onSubmit:t.onSubmit,validate:s||function(){return l}});return(0,n.jsx)("form",{id:t.id,name:t.name,onSubmit:c.handleSubmit,className:t.className,style:t.style,method:"POST","data-sentry-component":"Form","data-sentry-source-file":"Form.tsx",children:(0,n.jsx)(i.o,{values:c.values,errors:c.errors,formContextOnChange:c.handleChange,handleBlur:c.handleBlur,touched:c.touched,fieldLevelValidation:function(e,s){d({key:e,error:s})},"data-sentry-element":"FormContextProvider","data-sentry-source-file":"Form.tsx",children:t.children({errors:c.errors,touched:c.touched,isSubmitting:c.isSubmitting,isValidating:c.isValidating,submitCount:c.submitCount,initialValues:c.initialValues,values:c.values,handleReset:c.handleReset,resetForm:c.resetForm,setFieldValue:c.setFieldValue})})})}},73500:function(e,s,t){"use strict";var n=t(97458),a=t(52983),o=t(68249),i=t(51487),r=t(16720),l=t(25843),d=t(11499);s.Z=function(e){let{defaultValue:s,descriptionText:t,error:c,icon:u,inputRef:m,label:x,afterLabel:p,beforeLabel:h,labelOptional:f,layout:g,value:y,actions:j,size:v="medium",validation:b,id:w="",name:N="",...S}=e,C=(0,l.Z)("inputNumber"),{formContextOnChange:P,values:k,errors:z,handleBlur:_,touched:I,fieldLevelValidation:M}=(0,d.G)();k&&!y&&(y=k[w||N]),c||(z&&!c&&(c=z[w||N]),c=I&&I[w||N]?c:void 0),(0,a.useEffect)(()=>{b&&M(w,b(y))},[]);let D=[C.base];return c&&D.push(C.variants.error),c||D.push(C.variants.standard),u&&D.push(C.with_icon),v&&D.push(C.size[v]),S.disabled&&D.push(C.disabled),(0,n.jsx)("div",{className:S.className,"data-sentry-component":"InputNumber","data-sentry-source-file":"InputNumber.tsx",children:(0,n.jsx)(o.l,{label:x,afterLabel:p,beforeLabel:h,labelOptional:f,layout:g,id:w,error:c,descriptionText:t,style:S.style,size:v,"data-sentry-element":"FormLayout","data-sentry-source-file":"InputNumber.tsx",children:(0,n.jsxs)("div",{className:C.container,children:[(0,n.jsx)("input",{"data-size":v,id:w,name:N,onChange:function(e){S.onChange&&S.onChange(e),P&&P(e),b&&M(w,b(e.target.value))},onBlur:function(e){_&&_(e),S.onBlur&&S.onBlur(e)},type:"number",ref:m,value:y,className:D.join(" "),...S}),u&&(0,n.jsx)(r.Z,{size:v,icon:u}),c||j?(0,n.jsxs)("div",{className:C.actions_container,children:[c&&(0,n.jsx)(i.Z,{size:v}),j&&j]}):null]})})})}},85818:function(e,s,t){"use strict";t.d(s,{Z:function(){return g}});var n=t(97458),a=t(44809),o=t(62923),i=t.n(o),r=t(52983),l=t(68249),d=t(51487),c=t(16720),u=t(25843),m=t(65092),x=t(11499);let p=(0,r.createContext)({onChange:e=>{},selected:void 0});var h=t(62507);function f(e){let{children:s,className:t,buttonClassName:o,descriptionText:h,error:f,icon:g,id:y="",name:j="",label:v,labelOptional:b,layout:w,value:N,onChange:S,onFocus:C,onBlur:P,style:k,size:z="medium",defaultValue:_,validation:I,disabled:M,optionsWidth:D}=e,[A,Z]=(0,r.useState)(void 0),[R,F]=(0,r.useState)({}),T=(0,u.Z)("listbox"),B=(0,r.useRef)(null),{formContextOnChange:O,values:L,errors:E,handleBlur:V,touched:G,fieldLevelValidation:Y}=(0,x.G)();L&&!N&&(N=L[y||j],_=L[y||j]),f||(E&&!f&&(f=E[y||j]),f=G&&G[y||j]?f:void 0),(0,r.useEffect)(()=>{void 0!==N&&Z(N)},[N]),(0,r.useEffect)(()=>{function e(){var e;document.documentElement.style.setProperty("--width-listbox","".concat(D||(null===(e=B.current)||void 0===e?void 0:e.offsetWidth),"px"))}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{var e;let t=i()(s);function n(e){return t.find(s=>s.props.value===e)}if(N){Z(N);let e=n(N);F((null==e?void 0:e.props)?e.props:void 0);return}if(A){let e=n(A);F((null==e?void 0:e.props)?e.props:void 0);return}if(_){Z(_);let e=n(A);F((null==e?void 0:e.props)?e.props:void 0);return}F(null===(e=t[0])||void 0===e?void 0:e.props)},[A]);let U=[T.container,T.base,o],q=[T.addOnBefore];return f&&U.push(T.variants.error),f||U.push(T.variants.standard),g&&q.push(T.with_icon),z&&U.push(T.size[z]),M&&U.push(T.disabled),(0,n.jsx)(l.l,{label:v,labelOptional:b,layout:w,id:y,error:f,descriptionText:h,className:t,style:k,size:z,"data-sentry-element":"FormLayout","data-sentry-component":"Listbox","data-sentry-source-file":"Listbox2.tsx",children:(0,n.jsxs)(a.fC,{"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:[(0,n.jsx)(a.xz,{asChild:!0,disabled:M,"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:(0,n.jsxs)("button",{"data-size":z,ref:B,className:(0,m.cn)(U),onBlur:function(e){V&&V(e),P&&P(e)},onFocus:C,name:j,id:y,children:[(0,n.jsxs)("span",{className:(0,m.cn)(q),children:[g&&(0,n.jsx)(c.Z,{size:z,icon:g}),(null==R?void 0:R.addOnBefore)&&(0,n.jsx)(R.addOnBefore,{}),(0,n.jsx)("span",{className:T.label,children:null==R?void 0:R.label})]}),(0,n.jsx)("span",{className:T.chevron_container,children:(0,n.jsx)("svg",{className:T.chevron,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-sentry-element":"svg","data-sentry-source-file":"Listbox2.tsx",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd","data-sentry-element":"path","data-sentry-source-file":"Listbox2.tsx"})})}),f&&(0,n.jsx)("div",{className:T.actions_container,children:f&&(0,n.jsx)(d.Z,{size:z})})]})}),(0,n.jsx)(a.VY,{sideOffset:6,loop:!0,side:"bottom",align:"center",className:T.options_container,"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:(0,n.jsx)("div",{children:(0,n.jsx)(p.Provider,{value:{onChange:function(e){S&&S(e),Z(e);let s={};s.target={type:"select",name:j,id:y,value:e,checked:void 0},O&&O(s),I&&Y(y,I(e))},selected:A},"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:s})})})]})})}f.Option=function(e){let{id:s,value:t,label:o,disabled:i=!1,children:r,className:l="",addOnBefore:d}=e,c=(0,u.Z)("listbox");return(0,n.jsx)(p.Consumer,{"data-sentry-element":"unknown","data-sentry-component":"SelectOption","data-sentry-source-file":"Listbox2.tsx",children:e=>{let{onChange:o,selected:u}=e,x=u===t;return(0,n.jsxs)(a.ck,{className:(0,m.cn)(c.option,x?c.option_active:" ",i?c.option_disabled:" ",l),onSelect:()=>i?{}:o(t),children:[(0,n.jsxs)("div",{className:c.option_inner,children:[d&&d({active:x,selected:u}),(0,n.jsx)("span",{children:"function"==typeof r?r({active:x,selected:u}):r})]}),x?(0,n.jsx)("span",{className:(0,m.cn)(c.option_check,x?c.option_check_active:""),children:(0,n.jsx)(h.Z,{className:c.option_check_icon,"aria-hidden":"true"})}):null]},s)}})};var g=f},62210:function(e,s,t){"use strict";t.d(s,{r:function(){return c}});var n=t(97458),a=t(56384),o=t(31706),i=t(52983),r=t(65092);let l=(0,o.j)("peer inline-flex shrink-0 cursor-pointer items-center rounded-full border transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-brand data-[state=checked]:hover:bg-brand-600/90 data-[state=unchecked]:bg-control data-[state=unchecked]:hover:bg-border",{variants:{size:{small:"h-[16px] w-[28px]",medium:"h-[20px] w-[34px]",large:"h-[24px] w-[44px]"}},defaultVariants:{size:"medium"}}),d=(0,o.j)("pointer-events-none block rounded-full bg-foreground-lighter data-[state=checked]:bg-white shadow-lg ring-0 transition-transform",{variants:{size:{small:"h-[12px] w-[12px] data-[state=checked]:translate-x-[13px] data-[state=unchecked]:translate-x-[1px]",medium:"h-[16px] w-[16px] data-[state=checked]:translate-x-[15px] data-[state=unchecked]:translate-x-[1px]",large:"h-[18px] w-[18px] data-[state=checked]:translate-x-[22px] data-[state=unchecked]:translate-x-[3px]"}},defaultVariants:{size:"medium"}}),c=i.forwardRef((e,s)=>{let{className:t,size:o,...i}=e;return(0,n.jsx)(a.fC,{className:(0,r.cn)(l({size:o}),t),...i,ref:s,children:(0,n.jsx)(a.bU,{className:(0,r.cn)(d({size:o}))})})});c.displayName=a.fC.displayName}},function(e){e.O(0,[7623,588,783,1018,1706,1864,8703,2397,3954,9621,9911,659,7612,4637,9344,7726,6739,6436,8985,5518,8213,9849,3262,793,3594,3861,6120,7094,4334,3204,9774,2888,179],function(){return e(e.s=9672)}),_N_E=e.O()}]);