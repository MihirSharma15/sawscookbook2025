!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="bc2e4cf7-a7a5-4189-93e0-c5b7a311b89d",e._sentryDebugIdIdentifier="sentry-dbid-bc2e4cf7-a7a5-4189-93e0-c5b7a311b89d")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7940],{49017:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/settings/storage",function(){return s(30687)}])},67628:function(e,t,s){"use strict";s.d(t,{Q:function(){return i}});var n=s(97458),a=s(94059),r=s(73565),l=s(55228),i=e=>{let{page:t,menu:s}=e;return(0,n.jsx)("div",{className:"flex flex-col space-y-8 overflow-y-auto","data-sentry-component":"ProductMenu","data-sentry-source-file":"ProductMenu.tsx",children:(0,n.jsx)(a.ZP,{type:"pills","data-sentry-element":"Menu","data-sentry-source-file":"ProductMenu.tsx",children:s.map((e,i)=>(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"my-6 space-y-8",children:(0,n.jsxs)("div",{className:"mx-3",children:[(0,n.jsx)(a.ZP.Group,{title:e.title?(0,n.jsxs)("div",{className:"flex flex-col space-y-2 uppercase font-mono",children:[(0,n.jsx)("span",{children:e.title}),e.isPreview&&(0,n.jsx)(r.C,{variant:"warning",children:"Not production ready"})]}):null}),(0,n.jsx)("div",{children:e.items.map(e=>(0,n.jsx)(l.Z,{url:e.url,name:e.name,icon:e.icon,rightIcon:e.rightIcon,isActive:t===e.key,isExternal:e.isExternal,target:e.isExternal?"_blank":"_self",label:e.label},e.key))})]})}),i!==s.length-1&&(0,n.jsx)("div",{className:"h-px w-full bg-border-overlay"})]},e.key||e.title))})})}},19697:function(e,t,s){"use strict";s.d(t,{Z:function(){return h}});var n=s(97458),a=s(32691),r=s(52983),l=s(12436),i=s(67628),o=s(71147),c=s(75541),d=s(62432),u=s(58326),f=s(21786),x=s(37756),m=s(74334),p=s(13510);let y=(e,t,s,a)=>{var r,l,i,o;let c=(null==t?void 0:t.status)===x.S.COMING_UP,d="/project/".concat(e),u=null===(r=null==a?void 0:a.auth)||void 0===r||r,f=null===(l=null==a?void 0:a.edgeFunctions)||void 0===l||l,m=null===(i=null==a?void 0:a.storage)||void 0===i||i,y=null!==(o=null==a?void 0:a.diskAndCompute)&&void 0!==o&&o;return[{title:"Project Settings",items:[{name:"General",key:"general",url:"/project/".concat(e,"/settings/general"),items:[]},...x.Qy&&y?[{name:"Compute and Disk",key:"compute-and-disk",url:"/project/".concat(e,"/settings/compute-and-disk"),items:[]}]:[],{name:"Infrastructure",key:"infrastructure",url:c?d:"/project/".concat(e,"/settings/infrastructure"),items:[]},...x.Qy?[{name:"Integrations",key:"integrations",url:"/project/".concat(e,"/settings/integrations"),items:[]}]:[],{name:"Add Ons",key:"addons",url:"/project/".concat(e,"/settings/addons"),items:[]},{name:"Vault",key:"vault",url:c?d:"/project/".concat(e,"/integrations/vault/overview"),items:[],rightIcon:(0,n.jsx)(p.Z,{strokeWidth:1,className:"h-4 w-4"}),label:"Alpha"}]},{title:"Configuration",items:[{name:"Database",key:"database",url:c?d:"/project/".concat(e,"/settings/database"),items:[]},{name:"API",key:"api",url:c?d:"/project/".concat(e,"/settings/api"),items:[]},...x.Qy&&u?[{name:"Authentication",key:"auth",url:c?d:"/project/".concat(e,"/settings/auth"),items:[]}]:[],...x.Qy&&m?[{name:"Storage",key:"storage",url:"/project/".concat(e,"/settings/storage"),items:[]}]:[],...x.Qy&&f?[{name:"Edge Functions",key:"functions",url:"/project/".concat(e,"/settings/functions"),items:[]}]:[],...x.Qy?[{name:"Log Drains",key:"log-drains",url:"/project/".concat(e,"/settings/log-drains"),items:[]}]:[]]},{title:"Billing",items:[{name:"Subscription",key:"subscription",url:"/org/".concat(null==s?void 0:s.slug,"/billing"),items:[]},{name:"Usage",key:"usage",url:"/org/".concat(null==s?void 0:s.slug,"/usage?projectRef=").concat(e),items:[]}]}]};var h=(0,u.Q)(e=>{let{title:t,children:s}=e,u=(0,a.useRouter)(),{ref:p}=(0,l.UO)(),h=(0,d.Vm)(),j=(0,c.l)();(0,r.useEffect)(()=>{x.Qy||u.push("/project/default")},[u]);let g=u.pathname.includes("billing")?u.pathname.split("/")[5]:u.pathname.split("/")[4],{projectAuthAll:v,projectEdgeFunctionAll:N,projectStorageAll:b,billingInvoices:C}=(0,o.N)(["project_auth:all","project_edge_function:all","project_storage:all","billing:invoices"]),S=y(p,h,j,{auth:v,edgeFunctions:N,storage:b,invoices:C,diskAndCompute:(0,f.P)("diskAndComputeForm")});return(0,n.jsx)(m.Z,{isBlocking:!1,title:t||"Settings",product:"Settings",productMenu:(0,n.jsx)(i.Q,{page:g,menu:S}),"data-sentry-element":"ProjectLayout","data-sentry-component":"SettingsLayout","data-sentry-source-file":"SettingsLayout.tsx",children:s})})},78066:function(e,t,s){"use strict";s.d(t,{CG:function(){return p},FW:function(){return u},I7:function(){return x},Lc:function(){return h},Wv:function(){return g},_S:function(){return f},g$:function(){return y},gW:function(){return N},jX:function(){return m},q7:function(){return d},s_:function(){return o},tM:function(){return j},tU:function(){return c},ur:function(){return v},y:function(){return i}});var n=s(97458),a=s(52983),r=s(86186),l=s(65092);let i="mx-auto w-full max-w-[1200px]",o="px-4 md:px-6 lg:px-14 xl:px-24 2xl:px-28",c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("header",{...a,ref:t,className:(0,l.cn)("w-full","flex-col gap-3 py-6",s)})}),d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("h1",{ref:t,...a,className:(0,l.cn)("text-2xl",s)})}),u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("span",{ref:t,...a,className:(0,l.cn)("text-sm text-foreground-light",s)})}),f=a.forwardRef((e,t)=>{let{className:s,bottomPadding:a,...c}=e,{aiAssistantPanel:d}=(0,r.WZ)(),{open:u}=d;return(0,n.jsx)("div",{ref:t,...c,className:(0,l.cn)(i,o,a&&"pb-16",u?"xl:px-6":"",s)})}),x=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,l.cn)("w-full h-px bg-border",s)})}),m=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,l.cn)("flex flex-col gap-3 py-6","lg:grid md:grid-cols-12 lg:py-12",s)})}),p=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,l.cn)("flex flex-col gap-3","min-w-[420px]",s)})}),y=a.forwardRef((e,t)=>{let{className:s,children:a,title:r,...i}=e;return(0,n.jsxs)("div",{ref:t,...i,className:(0,l.cn)("col-span-4 xl:col-span-5 prose text-sm",s),children:[r&&(0,n.jsx)("h2",{children:r}),a]})}),h=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,l.cn)("col-span-8 xl:col-span-7","flex flex-col gap-6",s)})}),j=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,l.cn)("flex flex-col gap-3 items-center",s)})}),g=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,l.cn)("flex w-full items-center",s)})}),v=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,l.cn)("flex flex-row gap-3",s)})}),N=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,l.cn)(i,o,"my-8 flex flex-col gap-8",s)})});c.displayName="ScaffoldHeader",d.displayName="ScaffoldTitle",u.displayName="ScaffoldDescription",f.displayName="ScaffoldContainer",x.displayName="ScaffoldDivider",m.displayName="ScaffoldSection",p.displayName="ScaffoldColumn",y.displayName="ScaffoldSectionDetail",h.displayName="ScaffoldSectionContent",j.displayName="ScaffoldFilterAndContent",g.displayName="ScaffoldActionsContainer",v.displayName="ScaffoldActionsGroup",N.displayName="ScaffoldContainerLegacy"},66318:function(e,t,s){"use strict";var n=s(97458),a=s(62507),r=s(57304),l=s(52983),i=s(45536),o=s(90839),c=s(65092);t.Z=e=>{var t;let{text:s,iconOnly:d=!1,children:u,onClick:f,copyLabel:x="Copy",copiedLabel:m="Copied",...p}=e,[y,h]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{if(!y)return;let e=setTimeout(()=>h(!1),2e3);return()=>clearTimeout(e)},[y]),(0,n.jsx)(o.z,{onClick:async e=>{h(!0),await (0,i.vQ)(s),null==f||f(e)},...p,className:(0,c.cn)({"px-1":d},p.className),icon:y?(0,n.jsx)(a.Z,{strokeWidth:2,className:"text-brand"}):null!==(t=p.icon)&&void 0!==t?t:(0,n.jsx)(r.Z,{}),"data-sentry-element":"Button","data-sentry-component":"CopyButton","data-sentry-source-file":"CopyButton.tsx",children:!d&&(0,n.jsx)(n.Fragment,{children:null!=u?u:y?m:x})})}},24083:function(e,t,s){"use strict";s.d(t,{p:function(){return l}});var n=s(97458),a=s(65092),r=s(67096);let l=e=>{let{title:t,description:s,docsUrl:l,actions:i,className:o}=e;return(0,n.jsxs)("div",{className:(0,a.cn)("w-full mb-6 flex flex-col sm:flex-row md:items-center justify-between gap-4 ".concat(o)),"data-sentry-component":"FormHeader","data-sentry-source-file":"FormHeader.tsx",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("h3",{className:"text-foreground text-xl prose",children:t}),s&&(0,n.jsx)("div",{className:"prose text-sm max-w-full",children:s})]}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row md:items-center gap-x-2",children:[void 0!==l&&(0,n.jsx)(r.G,{href:l}),i]})]})}},55228:function(e,t,s){"use strict";var n=s(97458),a=s(83145),r=s.n(a),l=s(94059),i=s(73565),o=s(90839);t.Z=e=>{let{name:t="",isActive:s,isExternal:a,icon:c,rightIcon:d,url:u="",target:f="_self",onClick:x,textClassName:m="",hoverText:p="",label:y}=e,h=(0,n.jsx)(l.ZP.Item,{icon:c,rounded:!0,active:s,onClick:x,children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-between gap-1",children:[(0,n.jsxs)("div",{title:p||("string"==typeof t?t:""),className:"flex items-center gap-2 truncate w-full "+m,children:[(0,n.jsxs)("span",{className:"truncate",children:[t," "]}),void 0!==y&&(0,n.jsx)(i.C,{variant:"warning",className:"py-0 px-1.5 capitalize",children:y})]}),d&&(0,n.jsx)("div",{children:d})]})});return u?a?(0,n.jsx)(o.z,{asChild:!0,block:!0,className:"!justify-start",type:"text",size:"small",icon:c,children:(0,n.jsx)(r(),{href:u,target:"_blank",rel:"noreferrer",children:t})}):(0,n.jsx)(r(),{href:u,className:"block",target:f,children:h}):h}},30687:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ei}});var n=s(97458),a=s(19697),r=s(78066),l=s(23669),i=s(78751),o=s(198),c=s(10947),d=s(83145),u=s.n(d),f=s(52983),x=s(86848),m=s(34549),p=s(5394),y=s(12436),h=s(88971),j=s(57006),g=s(5529),v=s(24083),N=s(61767),b=s(18186),C=s(31485),S=s(28927),k=s(82937),w=s(28894),R=s(6464);let _=e=>["projects",e,"storage-credentials"];var D=s(37756);async function I(e,t){let{projectRef:s}=e;if(!s)throw Error("projectRef is required");let{data:n,error:a}=await (0,R.U2)("/platform/storage/{ref}/credentials",{params:{path:{ref:s}},signal:t});return a&&(0,R.S3)(a),n}let E=function(e){let{projectRef:t}=e,{enabled:s=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,w.a)(_(t),e=>{let{signal:s}=e;return I({projectRef:t},s)},{enabled:s&&D.Qy&&void 0!==t,...n})};var A=s(90817),M=s(49142),Z=s(62210),F=s(11221),z=s(90839),T=s(7756),P=s(85682),O=s(78366),L=s(89129),Q=s(36457),W=s(64618);let B=async e=>{let{description:t,projectRef:s}=e;if(!s)throw Error("projectRef is required");let{data:n,error:a}=await (0,R.v_)("/platform/storage/{ref}/credentials",{params:{path:{ref:s}},body:{description:t}});return a&&(0,R.S3)(a),n};var V=s(36210),X=s(40577);let q=e=>{let{visible:t,onOpenChange:s}=e,{ref:a}=(0,y.UO)(),r=(0,h.gY)(),[l,c]=(0,f.useState)(!1),d=(0,A.Xo)(o.KA.STORAGE_ADMIN_WRITE,"*"),{data:u}=(0,S.k)({projectRef:a}),j=null==u?void 0:u.features.s3Protocol.enabled,g=!r||!d||!j,v=p.z.object({description:p.z.string().min(3,{message:"Description must be at least 3 characters long"})}),N=(0,x.cI)({resolver:(0,i.F)(v),defaultValues:{description:""}}),{data:b,mutate:C,isLoading:k}=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,Q.NL)();return(0,W.D)(e=>B(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(_(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?m.Am.error("Failed to create S3 access key: ".concat(e.message)):t(e,s,n)},...s})}({onSuccess:()=>{c(!0),N.reset()}});async function w(e){C({projectRef:a,...e})}return(0,n.jsxs)(V.Vq,{open:t,onOpenChange:e=>{s(e),e||c(!1)},"data-sentry-element":"Dialog","data-sentry-component":"CreateCredentialModal","data-sentry-source-file":"CreateCredentialModal.tsx",children:[(0,n.jsxs)(X.u,{"data-sentry-element":"Tooltip","data-sentry-source-file":"CreateCredentialModal.tsx",children:[(0,n.jsx)(X.aJ,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"CreateCredentialModal.tsx",children:(0,n.jsx)(V.hg,{asChild:!0,"data-sentry-element":"DialogTrigger","data-sentry-source-file":"CreateCredentialModal.tsx",children:(0,n.jsx)(z.z,{type:"default",disabled:g,className:"pointer-events-auto","data-sentry-element":"Button","data-sentry-source-file":"CreateCredentialModal.tsx",children:"New access key"})})}),g&&(0,n.jsx)(X._v,{side:"bottom",children:r?j?d?"":"You need additional permissions to create new access keys":"Connection via S3 protocol is currently disabled":"Restore your project to create new access keys"})]}),(0,n.jsx)(V.cZ,{onInteractOutside:e=>{l&&e.preventDefault()},"data-sentry-element":"DialogContent","data-sentry-source-file":"CreateCredentialModal.tsx",children:l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(V.fK,{children:[(0,n.jsx)(V.$N,{children:"Save your new S3 access keys"}),(0,n.jsx)(V.Be,{children:"You won't be able to see them again. If you lose these access keys, you'll need to create a new ones."})]}),(0,n.jsx)(V.P3,{}),(0,n.jsxs)(V.VO,{className:"flex flex-col gap-4",children:[(0,n.jsx)(O.E,{label:"Access key ID",isReactForm:!1,children:(0,n.jsx)(P.I,{className:"input-mono",readOnly:!0,copy:!0,disabled:!0,value:null==b?void 0:b.access_key})}),(0,n.jsx)(O.E,{label:"Secret access key",isReactForm:!1,children:(0,n.jsx)(P.I,{className:"input-mono",readOnly:!0,copy:!0,disabled:!0,value:null==b?void 0:b.secret_key})})]}),(0,n.jsx)(V.cN,{children:(0,n.jsx)(z.z,{onClick:()=>{s(!1),c(!1)},children:"Done"})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(V.fK,{children:[(0,n.jsx)(V.$N,{children:"Create new S3 access keys"}),(0,n.jsx)(V.Be,{children:"S3 access keys provide full access to all S3 operations across all buckets and bypass any existing RLS policies."})]}),(0,n.jsx)(V.P3,{}),(0,n.jsx)(M.l0,{...N,children:(0,n.jsxs)("form",{onSubmit:N.handleSubmit(w),children:[(0,n.jsx)(V.VO,{children:(0,n.jsx)(M.Wi,{name:"description",render:()=>(0,n.jsx)(O.E,{label:"Description",children:(0,n.jsx)(P.I,{autoComplete:"off",placeholder:"My test key",type:"text",...N.register("description")})})})}),(0,n.jsx)(V.cN,{children:(0,n.jsx)(z.z,{htmlType:"submit",loading:k,children:"Create access key"})})]})})]})})]})},G=async e=>{let{projectRef:t,id:s}=e;if(!t||!s)throw Error("projectRef and id are required");let{data:n,error:a}=await (0,R.IV)("/platform/storage/{ref}/credentials/{id}",{params:{path:{ref:t,id:s}}});return a&&"Failed to delete project storage credential"!==a.message&&(0,R.S3)(a),n},U=e=>{let{visible:t,selectedCredential:s,onClose:a}=e,{ref:r}=(0,y.UO)(),{mutate:l,isLoading:i}=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,Q.NL)();return(0,W.D)(e=>G(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(_(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?m.Am.error("Failed to delete S3 access key: ".concat(e.message)):t(e,s,n)},...s})}({onSuccess:()=>{m.Am.success("Successfully revoked S3 access key"),a()}});return(0,n.jsx)(V.Vq,{open:t,"data-sentry-element":"Dialog","data-sentry-component":"RevokeCredentialModal","data-sentry-source-file":"RevokeCredentialModal.tsx",children:(0,n.jsxs)(V.cZ,{size:"small","data-sentry-element":"DialogContent","data-sentry-source-file":"RevokeCredentialModal.tsx",children:[(0,n.jsx)(V.fK,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"RevokeCredentialModal.tsx",children:(0,n.jsxs)(V.$N,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"RevokeCredentialModal.tsx",children:["Revoke credential ",(0,n.jsx)("code",{className:"text-sm",children:null==s?void 0:s.description})]})}),(0,n.jsx)(V.P3,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"RevokeCredentialModal.tsx"}),(0,n.jsx)(V.VO,{"data-sentry-element":"DialogSection","data-sentry-source-file":"RevokeCredentialModal.tsx",children:(0,n.jsx)(V.Be,{"data-sentry-element":"DialogDescription","data-sentry-source-file":"RevokeCredentialModal.tsx",children:"This action is irreversible and requests made with these access keys will stop working."})}),(0,n.jsxs)(V.cN,{className:"flex justify-end gap-x-1","data-sentry-element":"DialogFooter","data-sentry-source-file":"RevokeCredentialModal.tsx",children:[(0,n.jsx)(z.z,{type:"outline",onClick:()=>a(),"data-sentry-element":"Button","data-sentry-source-file":"RevokeCredentialModal.tsx",children:"Cancel"}),(0,n.jsx)(z.z,{type:"danger",loading:i,onClick:async()=>{s&&l({id:s.id,projectRef:r})},"data-sentry-element":"Button","data-sentry-source-file":"RevokeCredentialModal.tsx",children:"Yes, revoke access keys"})]})]})})};var H=s(58159),K=s(49085),Y=s(67254);function $(e,t){var s=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return s<0?-1:s>0?1:s}var J=s(68846),ee=s(74304),et=s(66318),es=s(14500);let en=e=>{let{description:t,id:s,created_at:a,access_key:r,onDeleteClick:l}=e,i=(0,A.Xo)(o.KA.STORAGE_ADMIN_WRITE,"*");return(0,n.jsxs)("tr",{className:"h-8 text-ellipsis group","data-sentry-component":"StorageCredItem","data-sentry-source-file":"StorageCredItem.tsx",children:[(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:"text-foreground",children:t})}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-ellipsis font-mono cursor-default",children:r}),(0,n.jsx)("span",{className:"w-24 text-right opacity-0 group-hover:opacity-100 transition-opacity",children:(0,n.jsx)(et.Z,{text:r,type:"default","data-sentry-element":"CopyButton","data-sentry-source-file":"StorageCredItem.tsx"})})]})}),(0,n.jsx)("td",{children:function(e){let t=function(e,t){(0,Y.Z)(2,arguments);var s=(0,H.default)(e),n=(0,H.default)(t),a=$(s,n),r=Math.abs((0,K.default)(s,n));s.setDate(s.getDate()-a*r);var l=Number($(s,n)===-a),i=a*(r-l);return 0===i?0:i}(new Date,new Date(e));return 0===t?"Today":1===t?"".concat(t," day ago"):"".concat(t," days ago")}(a)}),(0,n.jsx)("td",{className:"text-right",children:i&&(0,n.jsxs)(es.h_,{children:[(0,n.jsx)(es.$F,{asChild:!0,children:(0,n.jsx)(z.z,{icon:(0,n.jsx)(J.Z,{size:14,strokeWidth:1}),type:"text",className:"px-1.5 text-foreground-lighter hover:text-foreground"})}),(0,n.jsx)(es.AW,{className:"max-w-40",align:"end",children:(0,n.jsxs)(es.Xi,{className:"flex gap-1.5 ",onClick:e=>{e.preventDefault(),l(s)},children:[(0,n.jsx)(ee.Z,{size:"14"}),"Revoke key"]})})]})})]})};var ea=s(90616);let er=()=>{var e,t,s,a;let{ref:r}=(0,y.UO)(),l=(0,h.gY)(),{project:d,isLoading:w}=(0,h.d2)(),[R,_]=(0,f.useState)(!1),[D,I]=(0,f.useState)(!1),[Q,W]=(0,f.useState)(),B=(0,A.Xo)(o.KA.STORAGE_ADMIN_READ,"*"),V=(0,A.Xo)(o.KA.STORAGE_ADMIN_WRITE,"*"),{data:X}=(0,C.zR)({projectRef:r}),{data:G,error:H,isSuccess:K,isError:Y}=(0,S.k)({projectRef:r}),{data:$,isLoading:J}=E({projectRef:r},{enabled:B}),{mutate:ee,isLoading:et}=(0,k.l)({onSuccess:(e,t)=>{t.features&&er.reset({s3ConnectionEnabled:t.features.s3Protocol.enabled}),m.Am.success("Successfully updated storage settings")}}),es=p.Ry({s3ConnectionEnabled:p.O7()}),er=(0,x.cI)({resolver:(0,i.F)(es),defaultValues:{s3ConnectionEnabled:!1}}),el=null!==(a=null==X?void 0:null===(e=X.app_config)||void 0===e?void 0:e.protocol)&&void 0!==a?a:"https",ei=null==X?void 0:null===(t=X.app_config)||void 0===t?void 0:t.endpoint,eo=(null==$?void 0:$.data)&&$.data.length>0,ec=(0,ea.Vp)(null!=r?r:"",el,ei),ed=async e=>r?G?void ee({projectRef:r,features:{...null==G?void 0:G.features,s3Protocol:{enabled:e.s3ConnectionEnabled}}}):console.error("Storage config is required"):console.error("Project ref is required");return(0,f.useEffect)(()=>{er.reset({s3ConnectionEnabled:null==G?void 0:G.features.s3Protocol.enabled})},[K]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(M.l0,{...er,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"S3Connection.tsx",children:(0,n.jsxs)("form",{id:"s3-connection-form",onSubmit:er.handleSubmit(ed),children:[(0,n.jsx)(v.p,{title:"S3 Connection",description:"Connect to your bucket using any S3-compatible service via the S3 protocol",docsUrl:"https://supabase.com/docs/guides/storage/s3/authentication","data-sentry-element":"FormHeader","data-sentry-source-file":"S3Connection.tsx"}),w?(0,n.jsx)(L.A,{}):l?(0,n.jsxs)(b.Z,{className:"!mb-0",children:[(0,n.jsx)(M.Wi,{name:"s3ConnectionEnabled",control:er.control,render:e=>{let{field:t}=e;return(0,n.jsx)(O.E,{layout:"horizontal",className:"px-8 py-8 [&>*>label]:text-foreground",label:"Enable connection via S3 protocol",description:"Allow clients to connect to Supabase Storage via the S3 protocol",children:(0,n.jsx)(M.NI,{children:(0,n.jsx)(Z.r,{size:"large",checked:t.value,onCheckedChange:t.onChange,disabled:!K||t.disabled})})})}}),Y&&(0,n.jsx)("div",{className:"px-8 pb-8",children:(0,n.jsx)(g.Z,{subject:"Failed to retrieve storage configuration",error:H})}),(0,n.jsx)(F.Z,{className:"bg-border"}),(0,n.jsxs)("div",{className:"flex flex-col gap-y-4 py-8",children:[(0,n.jsx)(O.E,{layout:"horizontal",className:"px-8",label:"Endpoint",isReactForm:!1,children:(0,n.jsx)(P.I,{readOnly:!0,copy:!0,disabled:!0,value:ec})}),!w&&(0,n.jsx)(O.E,{layout:"horizontal",className:"px-8",label:"Region",isReactForm:!1,children:(0,n.jsx)(P.I,{className:"input-mono",copy:!0,disabled:!0,value:null==d?void 0:d.region})})]}),(0,n.jsx)(F.Z,{}),(0,n.jsxs)("div",{className:"flex items-center justify-between w-full gap-2 px-8 py-4",children:[V?(0,n.jsx)("div",{}):(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"You need additional permissions to update storage settings"}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(z.z,{type:"default",htmlType:"reset",onClick:()=>er.reset(),disabled:!er.formState.isDirty||!V||et,children:"Cancel"}),(0,n.jsx)(z.z,{type:"primary",htmlType:"submit",loading:et,disabled:!er.formState.isDirty||!V||et,children:"Save"})]})]})]}):(0,n.jsxs)(c.bZ,{variant:"warning",children:[(0,n.jsx)(T.aN,{}),(0,n.jsx)(c.Cd,{children:"Project is paused"}),(0,n.jsx)(c.X,{children:"To connect to your S3 bucket, you need to restore your project."}),(0,n.jsx)("div",{className:"mt-3 flex items-center space-x-2",children:(0,n.jsx)(z.z,{asChild:!0,type:"default",children:(0,n.jsx)(u(),{href:"/project/".concat(r),children:"Restore project"})})})]})]})}),(0,n.jsxs)("div",{children:[(0,n.jsx)(v.p,{title:"S3 Access Keys",description:"Manage your access keys for this project.",actions:(0,n.jsx)(q,{visible:R,onOpenChange:_}),"data-sentry-element":"FormHeader","data-sentry-source-file":"S3Connection.tsx"}),B?w?(0,n.jsx)(L.A,{}):l?(0,n.jsx)(n.Fragment,{children:J?(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)(L.A,{})}):(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsx)(j.Z,{head:[(0,n.jsx)(j.Z.th,{children:"Description"},""),(0,n.jsx)(j.Z.th,{children:"Access key ID"},""),(0,n.jsx)(j.Z.th,{children:"Created at"},""),(0,n.jsx)(j.Z.th,{},"actions")],body:eo?null===(s=$.data)||void 0===s?void 0:s.map(e=>(0,n.jsx)(en,{created_at:e.created_at,access_key:e.access_key,description:e.description,id:e.id,onDeleteClick:()=>{W(e),I(!0)}},e.id)):(0,n.jsx)(j.Z.tr,{children:(0,n.jsxs)(j.Z.td,{colSpan:4,className:"!rounded-b-md overflow-hidden",children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:"No access keys created"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"There are no access keys associated with your project yet"})]})})})})}):(0,n.jsxs)(c.bZ,{variant:"warning",children:[(0,n.jsx)(T.aN,{}),(0,n.jsx)(c.Cd,{children:"Can't fetch S3 access keys"}),(0,n.jsx)(c.X,{children:"To fetch your S3 access keys, you need to restore your project."}),(0,n.jsx)(c.X,{children:(0,n.jsx)(z.z,{asChild:!0,type:"default",className:"mt-3",children:(0,n.jsx)(u(),{href:"/project/".concat(r),children:"Restore project"})})})]}):(0,n.jsx)(N.Z,{resourceText:"view this project's S3 access keys"})]}),(0,n.jsx)(U,{visible:D,selectedCredential:Q,onClose:()=>{I(!1),W(void 0)},"data-sentry-element":"RevokeCredentialModal","data-sentry-source-file":"S3Connection.tsx"})]})},el=()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r._S,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"storage.tsx",children:(0,n.jsxs)(r.tU,{"data-sentry-element":"ScaffoldHeader","data-sentry-source-file":"storage.tsx",children:[(0,n.jsx)(r.q7,{"data-sentry-element":"ScaffoldTitle","data-sentry-source-file":"storage.tsx",children:"Storage Settings"}),(0,n.jsx)(r.FW,{"data-sentry-element":"ScaffoldDescription","data-sentry-source-file":"storage.tsx",children:"Configure your project's storage settings"})]})}),(0,n.jsxs)(r._S,{className:"flex flex-col gap-10",bottomPadding:!0,"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"storage.tsx",children:[(0,n.jsx)(l.cx,{"data-sentry-element":"StorageSettings","data-sentry-source-file":"storage.tsx"}),(0,n.jsx)(er,{"data-sentry-element":"S3Connection","data-sentry-source-file":"storage.tsx"})]})]});el.getLayout=e=>(0,n.jsx)(a.Z,{title:"Settings",children:e});var ei=el},85682:function(e,t,s){"use strict";s.d(t,{I:function(){return u}});var n=s(97458),a=s(58596),r=s(52983),l=s(65092),i=s(56740),o=s(90839),c=s(25843);function d(e){let{icon:t,className:s}=e;return(0,n.jsx)("div",{className:(0,l.cn)("absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-foreground-light",s),"data-sentry-component":"InputIconContainer","data-sentry-source-file":"InputIconContainer.tsx",children:t})}let u=(0,r.forwardRef)((e,t)=>{let{copy:s,icon:u,reveal:f=!1,actions:x,onCopy:m,iconContainerClassName:p,containerClassName:y,...h}=e,[j,g]=(0,r.useState)("Copy"),[v,N]=(0,r.useState)(!0),b=(0,c.Z)("input"),C=[];return u&&C.push(b.with_icon),(0,n.jsxs)("div",{className:(0,l.cn)("relative",y),children:[(0,n.jsx)(i.I,{ref:t,...h,onCopy:m,value:f&&v?"**** **** **** ****":h.value,className:(0,l.cn)(...C,h.className)}),u&&(0,n.jsx)(d,{icon:u,className:p}),s||x?(0,n.jsxs)("div",{className:b.actions_container,children:[s&&!(f&&v)?(0,n.jsx)(o.z,{size:"tiny",type:"default",icon:(0,n.jsx)(a.Z,{size:16,className:"text-foreground-muted"}),onClick:()=>{var e,t;return e=h.value,void(null===(t=navigator.clipboard.writeText(e))||void 0===t||t.then(function(){g("Copied"),setTimeout(function(){g("Copy")},3e3),null==m||m()},function(){g("Failed to copy")}))},children:j}):null,f&&v?(0,n.jsx)(o.z,{size:"tiny",type:"default",onClick:function(){N(!1)},children:"Reveal"}):null,x&&x]}):null]})})}},function(e){e.O(0,[3659,7623,588,783,1018,1706,1864,8703,2397,3954,9621,9911,659,7612,4637,9344,7726,6739,6436,8985,717,2478,1727,793,3594,3861,6120,7094,4334,1968,3669,9774,2888,179],function(){return e(e.s=49017)}),_N_E=e.O()}]);